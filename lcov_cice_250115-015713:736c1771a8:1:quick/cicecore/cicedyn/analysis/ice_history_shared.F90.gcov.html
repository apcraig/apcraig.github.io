<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - 250115-015713:736c1771a8:1:quick - cicecore/cicedyn/analysis/ice_history_shared.F90</title>
  <link rel="stylesheet" type="text/css" href="../../../gcov.css">
</head>

<body>

          <table width="100%" border=0 cellspacing=0 cellpadding=0>
            <tr><td class="title">LCOV - code coverage report</td></tr>
            <tr><td class="ruler"><img src="../../../glass.png" width=3 height=3 alt=""></td></tr>

            <tr>
              <td width="100%">
                <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="10%" class="headerValue"><a href="../../../index.html">top level</a> - <a href="index.html">cicecore/cicedyn/analysis</a> - ice_history_shared.F90<span style="font-size: 80%;"> (source / <a href="ice_history_shared.F90.func-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="5%"></td>
            <td width="5%" class="headerCovTableHead">Coverage</td>
            <td width="5%" class="headerCovTableHead" title="Covered + Uncovered code">Total</td>
            <td width="5%" class="headerCovTableHead" title="Exercised code only">Hit</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">250115-015713:736c1771a8:1:quick</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntryLo">47.13&nbsp;%</td>
            <td class="headerCovTableEntry">157</td>
            <td class="headerCovTableEntry">74</td>
          </tr>
          <tr>
            <td class="headerItem">Test Date:</td>
            <td class="headerValue">2025-01-14 19:10:33</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntryLo">50.00&nbsp;%</td>
            <td class="headerCovTableEntry">6</td>
            <td class="headerCovTableEntry">3</td>
          </tr>
                  <tr><td><img src="../../../glass.png" width=3 height=3 alt=""></td></tr>
                </table>
              </td>
            </tr>

            <tr><td class="ruler"><img src="../../../glass.png" width=3 height=3 alt=""></td></tr>
          </table>

          <table cellpadding=0 cellspacing=0 border=0>
            <tr>
              <td><br></td>
            </tr>
            <tr>
              <td>
<pre class="sourceHeading">            Line data    Source code</pre>
<pre class="source">
<span id="L1"><span class="lineNum">       1</span>              : !=======================================================================</span>
<span id="L2"><span class="lineNum">       2</span>              : !</span>
<span id="L3"><span class="lineNum">       3</span>              : ! Output files: netCDF or binary data, Fortran unformatted dumps</span>
<span id="L4"><span class="lineNum">       4</span>              : !</span>
<span id="L5"><span class="lineNum">       5</span>              : ! The following variables are currently hard-wired as snapshots</span>
<span id="L6"><span class="lineNum">       6</span>              : !   (instantaneous rather than time-averages):</span>
<span id="L7"><span class="lineNum">       7</span>              : !   divu, shear, vort, sig1, sig2, sigP, trsig, mlt_onset,</span>
<span id="L8"><span class="lineNum">       8</span>              : !   frz_onset, hisnap, aisnap</span>
<span id="L9"><span class="lineNum">       9</span>              : !</span>
<span id="L10"><span class="lineNum">      10</span>              : ! Options for histfreq: '1','h','d','m','y','x', where x means that</span>
<span id="L11"><span class="lineNum">      11</span>              : !   output stream will not be used (recommended for efficiency).</span>
<span id="L12"><span class="lineNum">      12</span>              : ! histfreq_n can be any nonnegative integer, where 0 means that the</span>
<span id="L13"><span class="lineNum">      13</span>              : !   corresponding histfreq frequency will not be used.</span>
<span id="L14"><span class="lineNum">      14</span>              : ! The flags (f_&lt;field&gt;) can be set to '1','h','d','m','y' or 'x', where</span>
<span id="L15"><span class="lineNum">      15</span>              : !   n means the field will not be written.  To output the same field at</span>
<span id="L16"><span class="lineNum">      16</span>              : !   more than one frequency, for instance monthy and daily, set</span>
<span id="L17"><span class="lineNum">      17</span>              : !   f_&lt;field&gt; = 'md'.</span>
<span id="L18"><span class="lineNum">      18</span>              : !</span>
<span id="L19"><span class="lineNum">      19</span>              : ! authors Tony Craig and Bruce Briegleb, NCAR</span>
<span id="L20"><span class="lineNum">      20</span>              : !         Elizabeth C. Hunke and William H. Lipscomb, LANL</span>
<span id="L21"><span class="lineNum">      21</span>              : !         C. M. Bitz, UW</span>
<span id="L22"><span class="lineNum">      22</span>              : !</span>
<span id="L23"><span class="lineNum">      23</span>              : ! 2012 Elizabeth Hunke split code from ice_history.F90</span>
<span id="L24"><span class="lineNum">      24</span>              : </span>
<span id="L25"><span class="lineNum">      25</span>              :       module ice_history_shared</span>
<span id="L26"><span class="lineNum">      26</span>              : </span>
<span id="L27"><span class="lineNum">      27</span>              :       use ice_kinds_mod</span>
<span id="L28"><span class="lineNum">      28</span>              :       use ice_communicate, only: my_task, master_task</span>
<span id="L29"><span class="lineNum">      29</span>              :       use ice_domain_size, only: max_nstrm</span>
<span id="L30"><span class="lineNum">      30</span>              :       use ice_exit, only: abort_ice</span>
<span id="L31"><span class="lineNum">      31</span>              :       use ice_fileunits, only: nu_diag</span>
<span id="L32"><span class="lineNum">      32</span>              :       use icepack_intfc, only: icepack_warnings_flush, icepack_warnings_aborted</span>
<span id="L33"><span class="lineNum">      33</span>              : </span>
<span id="L34"><span class="lineNum">      34</span>              :       implicit none</span>
<span id="L35"><span class="lineNum">      35</span>              : </span>
<span id="L36"><span class="lineNum">      36</span>              :       private</span>
<span id="L37"><span class="lineNum">      37</span>              :       public :: define_hist_field, accum_hist_field, icefields_nml, construct_filename</span>
<span id="L38"><span class="lineNum">      38</span>              : </span>
<span id="L39"><span class="lineNum">      39</span>              :       integer (kind=int_kind), public :: history_precision</span>
<span id="L40"><span class="lineNum">      40</span>              : </span>
<span id="L41"><span class="lineNum">      41</span>              :       logical (kind=log_kind), public :: &amp;</span>
<span id="L42"><span class="lineNum">      42</span>              :          hist_avg(max_nstrm)  ! if true, write averaged data instead of snapshots</span>
<span id="L43"><span class="lineNum">      43</span>              : </span>
<span id="L44"><span class="lineNum">      44</span>              :       character (len=char_len_long), public :: &amp;</span>
<span id="L45"><span class="lineNum">      45</span>              :          history_file  , &amp; ! output file for history   ! LCOV_EXCL_LINE</span>
<span id="L46"><span class="lineNum">      46</span>              :          incond_file       ! output file for snapshot initial conditions</span>
<span id="L47"><span class="lineNum">      47</span>              : </span>
<span id="L48"><span class="lineNum">      48</span>              :       character (len=char_len_long), public :: &amp;</span>
<span id="L49"><span class="lineNum">      49</span>              :          history_dir   , &amp; ! directory name for history file   ! LCOV_EXCL_LINE</span>
<span id="L50"><span class="lineNum">      50</span>              :          incond_dir        ! directory for snapshot initial conditions</span>
<span id="L51"><span class="lineNum">      51</span>              : </span>
<span id="L52"><span class="lineNum">      52</span>              :       character (len=char_len), public :: &amp;</span>
<span id="L53"><span class="lineNum">      53</span>              :          version_name</span>
<span id="L54"><span class="lineNum">      54</span>              : </span>
<span id="L55"><span class="lineNum">      55</span>              :       character (len=char_len), public :: &amp;</span>
<span id="L56"><span class="lineNum">      56</span>              :          history_format      , &amp; ! history format, cdf1, cdf2, cdf5, etc   ! LCOV_EXCL_LINE</span>
<span id="L57"><span class="lineNum">      57</span>              :          history_rearranger      ! history file rearranger, box or subset for pio</span>
<span id="L58"><span class="lineNum">      58</span>              : </span>
<span id="L59"><span class="lineNum">      59</span>              :       character (len=char_len), public :: &amp;</span>
<span id="L60"><span class="lineNum">      60</span>              :          hist_suffix(max_nstrm)  ! appended to history_file in filename</span>
<span id="L61"><span class="lineNum">      61</span>              : </span>
<span id="L62"><span class="lineNum">      62</span>              :       integer (kind=int_kind), public :: &amp;</span>
<span id="L63"><span class="lineNum">      63</span>              :          history_iotasks     , &amp; ! iotasks, root, stride defines io pes for pio   ! LCOV_EXCL_LINE</span>
<span id="L64"><span class="lineNum">      64</span>              :          history_root        , &amp; ! iotasks, root, stride defines io pes for pio   ! LCOV_EXCL_LINE</span>
<span id="L65"><span class="lineNum">      65</span>              :          history_stride      , &amp; ! iotasks, root, stride defines io pes for pio   ! LCOV_EXCL_LINE</span>
<span id="L66"><span class="lineNum">      66</span>              :          history_deflate     , &amp; ! compression level for hdf5/netcdf4   ! LCOV_EXCL_LINE</span>
<span id="L67"><span class="lineNum">      67</span>              :          history_chunksize(2) ! chunksize for hdf5/netcdf4</span>
<span id="L68"><span class="lineNum">      68</span>              : </span>
<span id="L69"><span class="lineNum">      69</span>              :       !---------------------------------------------------------------</span>
<span id="L70"><span class="lineNum">      70</span>              :       ! Instructions for adding a field: (search for 'example')</span>
<span id="L71"><span class="lineNum">      71</span>              :       !     Here or in ice_history_[process].F90:</span>
<span id="L72"><span class="lineNum">      72</span>              :       ! (1) Add to frequency flags (f_&lt;field&gt;)</span>
<span id="L73"><span class="lineNum">      73</span>              :       ! (2) Add to namelist (here and also in ice_in)</span>
<span id="L74"><span class="lineNum">      74</span>              :       ! (3) Add to index list</span>
<span id="L75"><span class="lineNum">      75</span>              :       !     In init_hist (in ice_history.F90):</span>
<span id="L76"><span class="lineNum">      76</span>              :       ! (4) Add define_hist_field call with vname, vdesc, vunit,</span>
<span id="L77"><span class="lineNum">      77</span>              :       !     and vcomment, vcellmeas, and conversion factor if necessary.</span>
<span id="L78"><span class="lineNum">      78</span>              :       ! (5) Add flag to broadcast list</span>
<span id="L79"><span class="lineNum">      79</span>              :       ! (6) Add accum_hist_field call with appropriate variable</span>
<span id="L80"><span class="lineNum">      80</span>              :       !---------------------------------------------------------------</span>
<span id="L81"><span class="lineNum">      81</span>              : </span>
<span id="L82"><span class="lineNum">      82</span>              :       type, public :: ice_hist_field</span>
<span id="L83"><span class="lineNum">      83</span>              :           character (len=16) :: vname     ! variable name</span>
<span id="L84"><span class="lineNum">      84</span>              :           character (len=16) :: vunit     ! variable units</span>
<span id="L85"><span class="lineNum">      85</span>              :           character (len=25) :: vcoord    ! variable coordinates</span>
<span id="L86"><span class="lineNum">      86</span>              :           character (len=16) :: vcellmeas ! variable cell measures</span>
<span id="L87"><span class="lineNum">      87</span>              :           character (len=55) :: vdesc     ! variable description</span>
<span id="L88"><span class="lineNum">      88</span>              :           character (len=55) :: vcomment  ! variable description</span>
<span id="L89"><span class="lineNum">      89</span>              :           real (kind=dbl_kind) :: cona    ! multiplicative conversion factor</span>
<span id="L90"><span class="lineNum">      90</span>              :           real (kind=dbl_kind) :: conb    ! additive conversion factor</span>
<span id="L91"><span class="lineNum">      91</span>              :           character (len=1) :: vhistfreq  ! frequency of history output</span>
<span id="L92"><span class="lineNum">      92</span>              :           integer (kind=int_kind) :: vhistfreq_n ! number of vhistfreq intervals</span>
<span id="L93"><span class="lineNum">      93</span>              :           logical (kind=log_kind) :: avg_ice_present ! only average where ice is present</span>
<span id="L94"><span class="lineNum">      94</span>              :           logical (kind=log_kind) :: mask_ice_free_points ! mask ice-free points</span>
<span id="L95"><span class="lineNum">      95</span>              :       end type</span>
<span id="L96"><span class="lineNum">      96</span>              : </span>
<span id="L97"><span class="lineNum">      97</span>              :       integer (kind=int_kind), parameter, public :: &amp;</span>
<span id="L98"><span class="lineNum">      98</span>              :          max_avail_hist_fields = 800      ! Max number of history fields</span>
<span id="L99"><span class="lineNum">      99</span>              : </span>
<span id="L100"><span class="lineNum">     100</span>              :       integer (kind=int_kind), public :: &amp;</span>
<span id="L101"><span class="lineNum">     101</span>              :          num_avail_hist_fields_tot  = 0, &amp; ! Current, total number of defined fields   ! LCOV_EXCL_LINE</span>
<span id="L102"><span class="lineNum">     102</span>              :          num_avail_hist_fields_2D   = 0, &amp; ! Number of 2D fields   ! LCOV_EXCL_LINE</span>
<span id="L103"><span class="lineNum">     103</span>              :          num_avail_hist_fields_3Dz  = 0, &amp; ! Number of 3D fields (vertical)   ! LCOV_EXCL_LINE</span>
<span id="L104"><span class="lineNum">     104</span>              :          num_avail_hist_fields_3Dc  = 0, &amp; ! Number of 3D fields (thickness categories)   ! LCOV_EXCL_LINE</span>
<span id="L105"><span class="lineNum">     105</span>              :          num_avail_hist_fields_3Db  = 0, &amp; ! Number of 3D fields (vertical biology)   ! LCOV_EXCL_LINE</span>
<span id="L106"><span class="lineNum">     106</span>              :          num_avail_hist_fields_3Da  = 0, &amp; ! Number of 3D fields (vertical), snow-biology   ! LCOV_EXCL_LINE</span>
<span id="L107"><span class="lineNum">     107</span>              :          num_avail_hist_fields_3Df  = 0, &amp; ! Number of 3D fields (floe size categories)   ! LCOV_EXCL_LINE</span>
<span id="L108"><span class="lineNum">     108</span>              :          num_avail_hist_fields_4Di  = 0, &amp; ! Number of 4D fields (categories,vertical), ice   ! LCOV_EXCL_LINE</span>
<span id="L109"><span class="lineNum">     109</span>              :          num_avail_hist_fields_4Ds  = 0, &amp; ! Number of 4D fields (categories,vertical), snow   ! LCOV_EXCL_LINE</span>
<span id="L110"><span class="lineNum">     110</span>              :          num_avail_hist_fields_4Df  = 0    ! Number of 4D fields (floe size, thickness categories)</span>
<span id="L111"><span class="lineNum">     111</span>              : </span>
<span id="L112"><span class="lineNum">     112</span>              :       integer (kind=int_kind), public :: &amp;        ! cumulative counts</span>
<span id="L113"><span class="lineNum">     113</span>              :          n2D     , &amp; ! num_avail_hist_fields_2D   ! LCOV_EXCL_LINE</span>
<span id="L114"><span class="lineNum">     114</span>              :          n3Dccum , &amp; ! n2D     + num_avail_hist_fields_3Dc   ! LCOV_EXCL_LINE</span>
<span id="L115"><span class="lineNum">     115</span>              :          n3Dzcum , &amp; ! n3Dccum + num_avail_hist_fields_3Dz   ! LCOV_EXCL_LINE</span>
<span id="L116"><span class="lineNum">     116</span>              :          n3Dbcum , &amp; ! n3Dzcum + num_avail_hist_fields_3Db   ! LCOV_EXCL_LINE</span>
<span id="L117"><span class="lineNum">     117</span>              :          n3Dacum , &amp; ! n3Dbcum + num_avail_hist_fields_3Da   ! LCOV_EXCL_LINE</span>
<span id="L118"><span class="lineNum">     118</span>              :          n3Dfcum , &amp; ! n3Dacum + num_avail_hist_fields_3Df   ! LCOV_EXCL_LINE</span>
<span id="L119"><span class="lineNum">     119</span>              :          n4Dicum , &amp; ! n3Dfcum + num_avail_hist_fields_4Di   ! LCOV_EXCL_LINE</span>
<span id="L120"><span class="lineNum">     120</span>              :          n4Dscum , &amp; ! n4Dicum + num_avail_hist_fields_4Ds   ! LCOV_EXCL_LINE</span>
<span id="L121"><span class="lineNum">     121</span>              :          n4Dfcum     ! n4Dscum + num_avail_hist_fields_4Df</span>
<span id="L122"><span class="lineNum">     122</span>              : </span>
<span id="L123"><span class="lineNum">     123</span>              :       ! could set nzilyr = nilyr + nslyr and write Tin+Tsn together into Tinz</span>
<span id="L124"><span class="lineNum">     124</span>              :       integer (kind=int_kind), public :: &amp;</span>
<span id="L125"><span class="lineNum">     125</span>              :          nzilyr , &amp; ! vertical dimension (allows alternative grids)   ! LCOV_EXCL_LINE</span>
<span id="L126"><span class="lineNum">     126</span>              :          nzslyr , &amp; ! snow   ! LCOV_EXCL_LINE</span>
<span id="L127"><span class="lineNum">     127</span>              :          nzblyr , &amp; ! bio grid   ! LCOV_EXCL_LINE</span>
<span id="L128"><span class="lineNum">     128</span>              :          nzalyr     ! aerosols (2 snow &amp; nblyr+2 bio)   ! LCOV_EXCL_LINE</span>
<span id="L129"><span class="lineNum">     129</span>              : </span>
<span id="L130"><span class="lineNum">     130</span>              :       type (ice_hist_field), public :: &amp;</span>
<span id="L131"><span class="lineNum">     131</span>              :          avail_hist_fields(max_avail_hist_fields)</span>
<span id="L132"><span class="lineNum">     132</span>              : </span>
<span id="L133"><span class="lineNum">     133</span>              :       integer (kind=int_kind), parameter, public :: &amp;</span>
<span id="L134"><span class="lineNum">     134</span>              :          ncoord   = 8           , &amp; ! number of coordinate variables: TLON, TLAT, ULON, ULAT, NLON, NLAT, ELON, ELAT   ! LCOV_EXCL_LINE</span>
<span id="L135"><span class="lineNum">     135</span>              :          nvar_grd = 21          , &amp; ! number of grid fields that can be written   ! LCOV_EXCL_LINE</span>
<span id="L136"><span class="lineNum">     136</span>              :                                     !   excluding grid vertices</span>
<span id="L137"><span class="lineNum">     137</span>              :          nvar_grdz = 6              ! number of category/vertical grid fields written</span>
<span id="L138"><span class="lineNum">     138</span>              : </span>
<span id="L139"><span class="lineNum">     139</span>              :       integer (kind=int_kind), public :: &amp;</span>
<span id="L140"><span class="lineNum">     140</span>              :          ncat_hist              , &amp; ! number of thickness categories written &lt;= ncat   ! LCOV_EXCL_LINE</span>
<span id="L141"><span class="lineNum">     141</span>              :          nfsd_hist                  ! number of floe size categories written &lt;= nfsd</span>
<span id="L142"><span class="lineNum">     142</span>              : </span>
<span id="L143"><span class="lineNum">     143</span>              :       real (kind=real_kind), public :: time_beg(max_nstrm), &amp; ! bounds for averaging</span>
<span id="L144"><span class="lineNum">     144</span>              :                                        time_end(max_nstrm), &amp;   ! LCOV_EXCL_LINE</span>
<span id="L145"><span class="lineNum">     145</span>              :                                        time_bounds(2)</span>
<span id="L146"><span class="lineNum">     146</span>              : </span>
<span id="L147"><span class="lineNum">     147</span>              :       character (len=char_len), public :: hist_time_axis</span>
<span id="L148"><span class="lineNum">     148</span>              : </span>
<span id="L149"><span class="lineNum">     149</span>              :       real (kind=dbl_kind), allocatable, public :: &amp;</span>
<span id="L150"><span class="lineNum">     150</span>              :          a2D (:,:,:,:)    , &amp; ! field accumulations/averages, 2D   ! LCOV_EXCL_LINE</span>
<span id="L151"><span class="lineNum">     151</span>              :          a3Dz(:,:,:,:,:)  , &amp; ! field accumulations/averages, 3D vertical   ! LCOV_EXCL_LINE</span>
<span id="L152"><span class="lineNum">     152</span>              :          a3Db(:,:,:,:,:)  , &amp; ! field accumulations/averages, 3D vertical biology   ! LCOV_EXCL_LINE</span>
<span id="L153"><span class="lineNum">     153</span>              :          a3Dc(:,:,:,:,:)  , &amp; ! field accumulations/averages, 3D thickness categories   ! LCOV_EXCL_LINE</span>
<span id="L154"><span class="lineNum">     154</span>              :          a3Da(:,:,:,:,:)  , &amp; ! field accumulations/averages, 3D snow+bio   ! LCOV_EXCL_LINE</span>
<span id="L155"><span class="lineNum">     155</span>              :          a3Df(:,:,:,:,:)  , &amp; ! field accumulations/averages, 3D floe size categories   ! LCOV_EXCL_LINE</span>
<span id="L156"><span class="lineNum">     156</span>              :          a4Di(:,:,:,:,:,:), &amp; ! field accumulations/averages, 4D categories,vertical, ice   ! LCOV_EXCL_LINE</span>
<span id="L157"><span class="lineNum">     157</span>              :          a4Ds(:,:,:,:,:,:), &amp; ! field accumulations/averages, 4D categories,vertical, snow   ! LCOV_EXCL_LINE</span>
<span id="L158"><span class="lineNum">     158</span>              :          a4Df(:,:,:,:,:,:)    ! field accumulations/averages, 4D floe size, thickness categories</span>
<span id="L159"><span class="lineNum">     159</span>              : </span>
<span id="L160"><span class="lineNum">     160</span>              :       real (kind=dbl_kind), allocatable, public :: &amp;</span>
<span id="L161"><span class="lineNum">     161</span>              :          Tinz4d (:,:,:,:)    , &amp; ! array for Tin   ! LCOV_EXCL_LINE</span>
<span id="L162"><span class="lineNum">     162</span>              :          Tsnz4d (:,:,:,:)    , &amp; ! array for Tsn   ! LCOV_EXCL_LINE</span>
<span id="L163"><span class="lineNum">     163</span>              :          Sinz4d (:,:,:,:)        ! array for Sin</span>
<span id="L164"><span class="lineNum">     164</span>              : </span>
<span id="L165"><span class="lineNum">     165</span>              :       real (kind=dbl_kind), public :: &amp;</span>
<span id="L166"><span class="lineNum">     166</span>              :          avgct(max_nstrm)   ! average sample counter</span>
<span id="L167"><span class="lineNum">     167</span>              : </span>
<span id="L168"><span class="lineNum">     168</span>              :       logical (kind=log_kind), public :: &amp;</span>
<span id="L169"><span class="lineNum">     169</span>              :          icoord(ncoord) , &amp;    ! true if coord field is written to output file   ! LCOV_EXCL_LINE</span>
<span id="L170"><span class="lineNum">     170</span>              :          igrd (nvar_grd), &amp;    ! true if grid field is written to output file   ! LCOV_EXCL_LINE</span>
<span id="L171"><span class="lineNum">     171</span>              :          igrdz(nvar_grdz)      ! true if category/vertical grid field is written</span>
<span id="L172"><span class="lineNum">     172</span>              : </span>
<span id="L173"><span class="lineNum">     173</span>              :       character (len=25), public, parameter :: &amp;</span>
<span id="L174"><span class="lineNum">     174</span>              :          ! T grids</span>
<span id="L175"><span class="lineNum">     175</span>              :          tcstr   = 'area: tarea'         , &amp; ! vcellmeas for T cell quantities</span>
<span id="L176"><span class="lineNum">     176</span>              :          tstr2D  = 'TLON TLAT time'      , &amp; ! vcoord for T cell, 2D   ! LCOV_EXCL_LINE</span>
<span id="L177"><span class="lineNum">     177</span>              :          tstr3Dc = 'TLON TLAT NCAT  time', &amp; ! vcoord for T cell, 3D, ncat   ! LCOV_EXCL_LINE</span>
<span id="L178"><span class="lineNum">     178</span>              :          tstr3Da = 'TLON TLAT VGRDa time', &amp; ! vcoord for T cell, 3D, ice-snow-bio   ! LCOV_EXCL_LINE</span>
<span id="L179"><span class="lineNum">     179</span>              :          tstr3Db = 'TLON TLAT VGRDb time', &amp; ! vcoord for T cell, 3D, ice-bio   ! LCOV_EXCL_LINE</span>
<span id="L180"><span class="lineNum">     180</span>              :          tstr3Df = 'TLON TLAT NFSD  time', &amp; ! vcoord for T cell, 3D, fsd   ! LCOV_EXCL_LINE</span>
<span id="L181"><span class="lineNum">     181</span>              :          tstr4Di = 'TLON TLAT VGRDi NCAT', &amp; ! vcoord for T cell, 4D, ice   ! LCOV_EXCL_LINE</span>
<span id="L182"><span class="lineNum">     182</span>              :          tstr4Ds = 'TLON TLAT VGRDs NCAT', &amp; ! vcoord for T cell, 4D, snow   ! LCOV_EXCL_LINE</span>
<span id="L183"><span class="lineNum">     183</span>              :          tstr4Df = 'TLON TLAT NFSD  NCAT', &amp; ! vcoord for T cell, 4D, fsd   ! LCOV_EXCL_LINE</span>
<span id="L184"><span class="lineNum">     184</span>              :          ! U grids</span>
<span id="L185"><span class="lineNum">     185</span>              :          ucstr   = 'area: uarea'         , &amp; ! vcellmeas for U cell quantities</span>
<span id="L186"><span class="lineNum">     186</span>              :          ustr2D  = 'ULON ULAT time'      , &amp; ! vcoord for U cell, 2D   ! LCOV_EXCL_LINE</span>
<span id="L187"><span class="lineNum">     187</span>              :          ! N grids</span>
<span id="L188"><span class="lineNum">     188</span>              :          ncstr   = 'area: narea'         , &amp; ! vcellmeas for N cell quantities</span>
<span id="L189"><span class="lineNum">     189</span>              :          nstr2D  = 'NLON NLAT time'      , &amp; ! vcoord for N cell, 2D   ! LCOV_EXCL_LINE</span>
<span id="L190"><span class="lineNum">     190</span>              :          ! E grids</span>
<span id="L191"><span class="lineNum">     191</span>              :          ecstr   = 'area: earea'         , &amp; ! vcellmeas for E cell quantities</span>
<span id="L192"><span class="lineNum">     192</span>              :          estr2D  = 'ELON ELAT time'          ! vcoord for E cell, 2D</span>
<span id="L193"><span class="lineNum">     193</span>              : </span>
<span id="L194"><span class="lineNum">     194</span>              :       !---------------------------------------------------------------</span>
<span id="L195"><span class="lineNum">     195</span>              :       ! flags: write to output file if true or histfreq value</span>
<span id="L196"><span class="lineNum">     196</span>              :       !---------------------------------------------------------------</span>
<span id="L197"><span class="lineNum">     197</span>              : </span>
<span id="L198"><span class="lineNum">     198</span>              :       logical (kind=log_kind), public :: &amp;</span>
<span id="L199"><span class="lineNum">     199</span>              :            f_tlon      = .true., f_tlat       = .true., &amp;   ! LCOV_EXCL_LINE</span>
<span id="L200"><span class="lineNum">     200</span>              :            f_ulon      = .true., f_ulat       = .true., &amp;   ! LCOV_EXCL_LINE</span>
<span id="L201"><span class="lineNum">     201</span>              :            f_nlon      = .true., f_nlat       = .true., &amp;   ! LCOV_EXCL_LINE</span>
<span id="L202"><span class="lineNum">     202</span>              :            f_elon      = .true., f_elat       = .true., &amp;   ! LCOV_EXCL_LINE</span>
<span id="L203"><span class="lineNum">     203</span>              :            f_tmask     = .true., f_umask      = .true., &amp;   ! LCOV_EXCL_LINE</span>
<span id="L204"><span class="lineNum">     204</span>              :            f_nmask     = .true., f_emask      = .true., &amp;   ! LCOV_EXCL_LINE</span>
<span id="L205"><span class="lineNum">     205</span>              :            f_blkmask   = .true., &amp;   ! LCOV_EXCL_LINE</span>
<span id="L206"><span class="lineNum">     206</span>              :            f_tarea     = .true., f_uarea      = .true., &amp;   ! LCOV_EXCL_LINE</span>
<span id="L207"><span class="lineNum">     207</span>              :            f_narea     = .true., f_earea      = .true., &amp;   ! LCOV_EXCL_LINE</span>
<span id="L208"><span class="lineNum">     208</span>              :            f_dxt       = .true., f_dyt        = .true., &amp;   ! LCOV_EXCL_LINE</span>
<span id="L209"><span class="lineNum">     209</span>              :            f_dxu       = .true., f_dyu        = .true., &amp;   ! LCOV_EXCL_LINE</span>
<span id="L210"><span class="lineNum">     210</span>              :            f_dxn       = .true., f_dyn        = .true., &amp;   ! LCOV_EXCL_LINE</span>
<span id="L211"><span class="lineNum">     211</span>              :            f_dxe       = .true., f_dye        = .true., &amp;   ! LCOV_EXCL_LINE</span>
<span id="L212"><span class="lineNum">     212</span>              :            f_HTN       = .true., f_HTE        = .true., &amp;   ! LCOV_EXCL_LINE</span>
<span id="L213"><span class="lineNum">     213</span>              :            f_ANGLE     = .true., f_ANGLET     = .true., &amp;   ! LCOV_EXCL_LINE</span>
<span id="L214"><span class="lineNum">     214</span>              :            f_bounds    = .true., f_NCAT       = .true., &amp;   ! LCOV_EXCL_LINE</span>
<span id="L215"><span class="lineNum">     215</span>              :            f_VGRDi     = .true., f_VGRDs      = .true., &amp;   ! LCOV_EXCL_LINE</span>
<span id="L216"><span class="lineNum">     216</span>              :            f_VGRDb     = .true., f_VGRDa      = .true., &amp;   ! LCOV_EXCL_LINE</span>
<span id="L217"><span class="lineNum">     217</span>              :            f_NFSD      = .false.</span>
<span id="L218"><span class="lineNum">     218</span>              : </span>
<span id="L219"><span class="lineNum">     219</span>              :       character (len=max_nstrm), public :: &amp;</span>
<span id="L220"><span class="lineNum">     220</span>              : !          f_example   = 'md', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L221"><span class="lineNum">     221</span>              :            f_hi        = 'm', f_hs         = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L222"><span class="lineNum">     222</span>              :            f_snowfrac  = 'x', f_snowfracn  = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L223"><span class="lineNum">     223</span>              :            f_Tsfc      = 'm', f_aice       = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L224"><span class="lineNum">     224</span>              :            f_uvel      = 'm', f_vvel       = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L225"><span class="lineNum">     225</span>              :            f_icespd    = 'm', f_icedir     = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L226"><span class="lineNum">     226</span>              :            f_uvelE     = 'x', f_vvelE      = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L227"><span class="lineNum">     227</span>              :            f_icespdE   = 'x', f_icedirE    = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L228"><span class="lineNum">     228</span>              :            f_uvelN     = 'x', f_vvelN      = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L229"><span class="lineNum">     229</span>              :            f_icespdN   = 'x', f_icedirN    = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L230"><span class="lineNum">     230</span>              :            f_uatm      = 'm', f_vatm       = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L231"><span class="lineNum">     231</span>              :            f_atmspd    = 'm', f_atmdir     = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L232"><span class="lineNum">     232</span>              :            f_fswup     = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L233"><span class="lineNum">     233</span>              :            f_fswdn     = 'm', f_flwdn      = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L234"><span class="lineNum">     234</span>              :            f_snow      = 'm', f_snow_ai    = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L235"><span class="lineNum">     235</span>              :            f_rain      = 'm', f_rain_ai    = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L236"><span class="lineNum">     236</span>              :            f_sst       = 'm', f_sss        = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L237"><span class="lineNum">     237</span>              :            f_uocn      = 'm', f_vocn       = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L238"><span class="lineNum">     238</span>              :            f_ocnspd    = 'm', f_ocndir     = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L239"><span class="lineNum">     239</span>              :            f_sice      = 'm', f_frzmlt     = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L240"><span class="lineNum">     240</span>              :            f_fswfac    = 'm', f_fswint_ai  = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L241"><span class="lineNum">     241</span>              :            f_fswabs    = 'm', f_fswabs_ai  = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L242"><span class="lineNum">     242</span>              :            f_albsni    = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L243"><span class="lineNum">     243</span>              :            f_alvdr     = 'x', f_alidr      = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L244"><span class="lineNum">     244</span>              :            f_alvdf     = 'x', f_alidf      = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L245"><span class="lineNum">     245</span>              :            f_alvdr_ai  = 'm', f_alidr_ai   = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L246"><span class="lineNum">     246</span>              :            f_alvdf_ai  = 'm', f_alidf_ai   = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L247"><span class="lineNum">     247</span>              :            f_albice    = 'm', f_albsno     = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L248"><span class="lineNum">     248</span>              :            f_albpnd    = 'm', f_coszen     = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L249"><span class="lineNum">     249</span>              :            f_flat      = 'm', f_flat_ai    = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L250"><span class="lineNum">     250</span>              :            f_fsens     = 'm', f_fsens_ai   = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L251"><span class="lineNum">     251</span>              :            f_flwup     = 'm', f_flwup_ai   = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L252"><span class="lineNum">     252</span>              :            f_evap      = 'm', f_evap_ai    = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L253"><span class="lineNum">     253</span>              :            f_Tair      = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L254"><span class="lineNum">     254</span>              :            f_Tref      = 'm', f_Qref       = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L255"><span class="lineNum">     255</span>              :            f_congel    = 'm', f_frazil     = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L256"><span class="lineNum">     256</span>              :            f_snoice    = 'm', f_dsnow      = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L257"><span class="lineNum">     257</span>              :            f_meltt     = 'm', f_melts      = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L258"><span class="lineNum">     258</span>              :            f_meltb     = 'm', f_meltl      = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L259"><span class="lineNum">     259</span>              :            f_fresh     = 'm', f_fresh_ai   = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L260"><span class="lineNum">     260</span>              :            f_fsalt     = 'm', f_fsalt_ai   = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L261"><span class="lineNum">     261</span>              :            f_fbot      = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L262"><span class="lineNum">     262</span>              :            f_fhocn     = 'm', f_fhocn_ai   = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L263"><span class="lineNum">     263</span>              :            f_fswthru   = 'm', f_fswthru_ai = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L264"><span class="lineNum">     264</span>              :            f_strairx   = 'm', f_strairy    = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L265"><span class="lineNum">     265</span>              :            f_strtltx   = 'm', f_strtlty    = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L266"><span class="lineNum">     266</span>              :            f_strcorx   = 'm', f_strcory    = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L267"><span class="lineNum">     267</span>              :            f_strocnx   = 'm', f_strocny    = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L268"><span class="lineNum">     268</span>              :            f_strintx   = 'm', f_strinty    = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L269"><span class="lineNum">     269</span>              :            f_taubx     = 'm', f_tauby      = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L270"><span class="lineNum">     270</span>              :            f_strairxN  = 'x', f_strairyN   = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L271"><span class="lineNum">     271</span>              :            f_strtltxN  = 'x', f_strtltyN   = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L272"><span class="lineNum">     272</span>              :            f_strcorxN  = 'x', f_strcoryN   = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L273"><span class="lineNum">     273</span>              :            f_strocnxN  = 'x', f_strocnyN   = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L274"><span class="lineNum">     274</span>              :            f_strintxN  = 'x', f_strintyN   = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L275"><span class="lineNum">     275</span>              :            f_taubxN    = 'x', f_taubyN     = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L276"><span class="lineNum">     276</span>              :            f_strairxE  = 'x', f_strairyE   = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L277"><span class="lineNum">     277</span>              :            f_strtltxE  = 'x', f_strtltyE   = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L278"><span class="lineNum">     278</span>              :            f_strcorxE  = 'x', f_strcoryE   = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L279"><span class="lineNum">     279</span>              :            f_strocnxE  = 'x', f_strocnyE   = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L280"><span class="lineNum">     280</span>              :            f_strintxE  = 'x', f_strintyE   = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L281"><span class="lineNum">     281</span>              :            f_taubxE    = 'x', f_taubyE     = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L282"><span class="lineNum">     282</span>              :            f_strength  = 'm', f_vort       = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L283"><span class="lineNum">     283</span>              :            f_divu      = 'm', f_shear      = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L284"><span class="lineNum">     284</span>              :            f_sig1      = 'm', f_sig2       = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L285"><span class="lineNum">     285</span>              :            f_sigP      = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L286"><span class="lineNum">     286</span>              :            f_dvidtt    = 'm', f_dvidtd     = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L287"><span class="lineNum">     287</span>              :            f_daidtt    = 'm', f_daidtd     = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L288"><span class="lineNum">     288</span>              :            f_dagedtt   = 'm', f_dagedtd    = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L289"><span class="lineNum">     289</span>              :            f_mlt_onset = 'm', f_frz_onset  = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L290"><span class="lineNum">     290</span>              :            f_iage      = 'm', f_FY         = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L291"><span class="lineNum">     291</span>              :            f_hisnap    = 'm', f_aisnap     = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L292"><span class="lineNum">     292</span>              :            f_CMIP = 'x'     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L293"><span class="lineNum">     293</span>              :            f_sithick   = 'x', f_sisnthick  = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L294"><span class="lineNum">     294</span>              :            f_siage     = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L295"><span class="lineNum">     295</span>              :            f_sitemptop = 'x', f_sitempsnic = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L296"><span class="lineNum">     296</span>              :            f_sitempbot = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L297"><span class="lineNum">     297</span>              :            f_sispeed   = 'x', f_sidir      = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L298"><span class="lineNum">     298</span>              :            f_siu       = 'x', f_siv        = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L299"><span class="lineNum">     299</span>              :            f_sidmasstranx = 'x', f_sidmasstrany = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L300"><span class="lineNum">     300</span>              :            f_sistrxdtop = 'x', f_sistrydtop = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L301"><span class="lineNum">     301</span>              :            f_sistrxubot = 'x', f_sistryubot = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L302"><span class="lineNum">     302</span>              :            f_sicompstren = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L303"><span class="lineNum">     303</span>              :            f_sialb     = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L304"><span class="lineNum">     304</span>              :            f_sihc      = 'x', f_sisnhc     = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L305"><span class="lineNum">     305</span>              :            f_sidconcth = 'x', f_sidconcdyn = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L306"><span class="lineNum">     306</span>              :            f_sidmassth = 'x', f_sidmassdyn = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L307"><span class="lineNum">     307</span>              :            f_sidmassgrowthwat = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L308"><span class="lineNum">     308</span>              :            f_sidmassgrowthbot = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L309"><span class="lineNum">     309</span>              :            f_sidmasssi = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L310"><span class="lineNum">     310</span>              :            f_sidmassevapsubl = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L311"><span class="lineNum">     311</span>              :            f_sndmasssubl = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L312"><span class="lineNum">     312</span>              :            f_sidmassmelttop = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L313"><span class="lineNum">     313</span>              :            f_sidmassmeltbot = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L314"><span class="lineNum">     314</span>              :            f_sidmasslat = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L315"><span class="lineNum">     315</span>              :            f_sndmasssnf = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L316"><span class="lineNum">     316</span>              :            f_sndmassmelt = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L317"><span class="lineNum">     317</span>              :            f_sndmassdyn = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L318"><span class="lineNum">     318</span>              :            f_siflswdtop = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L319"><span class="lineNum">     319</span>              :            f_siflswutop = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L320"><span class="lineNum">     320</span>              :            f_siflswdbot = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L321"><span class="lineNum">     321</span>              :            f_sifllwdtop = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L322"><span class="lineNum">     322</span>              :            f_sifllwutop = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L323"><span class="lineNum">     323</span>              :            f_siflsenstop = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L324"><span class="lineNum">     324</span>              :            f_siflsensupbot = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L325"><span class="lineNum">     325</span>              :            f_sifllatstop = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L326"><span class="lineNum">     326</span>              :            f_siflcondtop = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L327"><span class="lineNum">     327</span>              :            f_siflcondbot = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L328"><span class="lineNum">     328</span>              :            f_sipr = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L329"><span class="lineNum">     329</span>              :            f_sifb = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L330"><span class="lineNum">     330</span>              :            f_siflsaltbot = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L331"><span class="lineNum">     331</span>              :            f_siflfwbot = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L332"><span class="lineNum">     332</span>              :            f_siflfwdrain = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L333"><span class="lineNum">     333</span>              :            f_siforcetiltx = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L334"><span class="lineNum">     334</span>              :            f_siforcetilty = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L335"><span class="lineNum">     335</span>              :            f_siforcecoriolx = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L336"><span class="lineNum">     336</span>              :            f_siforcecorioly = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L337"><span class="lineNum">     337</span>              :            f_siforceintstrx = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L338"><span class="lineNum">     338</span>              :            f_siforceintstry = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L339"><span class="lineNum">     339</span>              :            f_siitdconc = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L340"><span class="lineNum">     340</span>              :            f_siitdthick = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L341"><span class="lineNum">     341</span>              :            f_siitdsnthick = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L342"><span class="lineNum">     342</span>              :            f_sidragtop = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L343"><span class="lineNum">     343</span>              :            f_sirdgthick = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L344"><span class="lineNum">     344</span>              :            f_sistreave = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L345"><span class="lineNum">     345</span>              :            f_sistremax = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L346"><span class="lineNum">     346</span>              :            f_aicen     = 'x', f_vicen      = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L347"><span class="lineNum">     347</span>              :            f_vsnon     = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L348"><span class="lineNum">     348</span>              :            f_trsig     = 'm', f_icepresent = 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L349"><span class="lineNum">     349</span>              :            f_fsurf_ai  = 'm', f_fcondtop_ai= 'm', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L350"><span class="lineNum">     350</span>              :            f_fmeltt_ai = 'm',                     &amp;   ! LCOV_EXCL_LINE</span>
<span id="L351"><span class="lineNum">     351</span>              :            f_fsurfn_ai = 'x' ,f_fcondtopn_ai='x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L352"><span class="lineNum">     352</span>              :            f_fmelttn_ai= 'x', f_flatn_ai   = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L353"><span class="lineNum">     353</span>              :            f_fsensn_ai = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L354"><span class="lineNum">     354</span>              : !          f_field3dz  = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L355"><span class="lineNum">     355</span>              :            f_keffn_top = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L356"><span class="lineNum">     356</span>              :            f_Tinz      = 'x', f_Sinz       = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L357"><span class="lineNum">     357</span>              :            f_Tsnz      = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L358"><span class="lineNum">     358</span>              :            f_a11       = 'x', f_a12        = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L359"><span class="lineNum">     359</span>              :            f_e11       = 'x', f_e12        = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L360"><span class="lineNum">     360</span>              :            f_e22       = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L361"><span class="lineNum">     361</span>              :            f_s11       = 'x', f_s12        = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L362"><span class="lineNum">     362</span>              :            f_s22       = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L363"><span class="lineNum">     363</span>              :            f_yieldstress11  = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L364"><span class="lineNum">     364</span>              :            f_yieldstress12  = 'x', &amp;   ! LCOV_EXCL_LINE</span>
<span id="L365"><span class="lineNum">     365</span>              :            f_yieldstress22  = 'x'</span>
<span id="L366"><span class="lineNum">     366</span>              : </span>
<span id="L367"><span class="lineNum">     367</span>              :       !---------------------------------------------------------------</span>
<span id="L368"><span class="lineNum">     368</span>              :       ! namelist variables</span>
<span id="L369"><span class="lineNum">     369</span>              :       !---------------------------------------------------------------</span>
<span id="L370"><span class="lineNum">     370</span>              : </span>
<span id="L371"><span class="lineNum">     371</span>              :       namelist / icefields_nml /     &amp;</span>
<span id="L372"><span class="lineNum">     372</span>              :            f_tlon     , f_tlat     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L373"><span class="lineNum">     373</span>              :            f_ulon     , f_ulat     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L374"><span class="lineNum">     374</span>              :            f_nlon     , f_nlat     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L375"><span class="lineNum">     375</span>              :            f_elon     , f_elat     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L376"><span class="lineNum">     376</span>              :            f_tmask    , f_umask    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L377"><span class="lineNum">     377</span>              :            f_nmask    , f_emask    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L378"><span class="lineNum">     378</span>              :            f_blkmask  , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L379"><span class="lineNum">     379</span>              :            f_tarea    , f_uarea    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L380"><span class="lineNum">     380</span>              :            f_narea    , f_earea    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L381"><span class="lineNum">     381</span>              :            f_dxt      , f_dyt      , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L382"><span class="lineNum">     382</span>              :            f_dxu      , f_dyu      , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L383"><span class="lineNum">     383</span>              :            f_dxn      , f_dyn      , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L384"><span class="lineNum">     384</span>              :            f_dxe      , f_dye      , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L385"><span class="lineNum">     385</span>              :            f_HTN      , f_HTE      , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L386"><span class="lineNum">     386</span>              :            f_ANGLE    , f_ANGLET   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L387"><span class="lineNum">     387</span>              :            f_bounds   , f_NCAT     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L388"><span class="lineNum">     388</span>              :            f_VGRDi    , f_VGRDs    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L389"><span class="lineNum">     389</span>              :            f_VGRDb    , f_VGRDa    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L390"><span class="lineNum">     390</span>              :            f_NFSD     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L391"><span class="lineNum">     391</span>              : !          f_example  , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L392"><span class="lineNum">     392</span>              :            f_hi,        f_hs       , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L393"><span class="lineNum">     393</span>              :            f_snowfrac,  f_snowfracn, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L394"><span class="lineNum">     394</span>              :            f_Tsfc,      f_aice     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L395"><span class="lineNum">     395</span>              :            f_uvel,      f_vvel     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L396"><span class="lineNum">     396</span>              :            f_icespd,    f_icedir   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L397"><span class="lineNum">     397</span>              : !          For now, C and CD grid quantities are controlled by the generic (originally B-grid) namelist flag</span>
<span id="L398"><span class="lineNum">     398</span>              : !          f_uvelE,     f_vvelE    , &amp;</span>
<span id="L399"><span class="lineNum">     399</span>              : !          f_icespdE,   f_icedirE  , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L400"><span class="lineNum">     400</span>              : !          f_uvelN,     f_vvelN    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L401"><span class="lineNum">     401</span>              : !          f_icespdN,   f_icedirN  , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L402"><span class="lineNum">     402</span>              :            f_uatm,      f_vatm     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L403"><span class="lineNum">     403</span>              :            f_atmspd,    f_atmdir   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L404"><span class="lineNum">     404</span>              :            f_fswup,     &amp;   ! LCOV_EXCL_LINE</span>
<span id="L405"><span class="lineNum">     405</span>              :            f_fswdn,     f_flwdn    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L406"><span class="lineNum">     406</span>              :            f_snow,      f_snow_ai  , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L407"><span class="lineNum">     407</span>              :            f_rain,      f_rain_ai  , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L408"><span class="lineNum">     408</span>              :            f_sst,       f_sss      , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L409"><span class="lineNum">     409</span>              :            f_uocn,      f_vocn     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L410"><span class="lineNum">     410</span>              :            f_ocnspd,    f_ocndir   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L411"><span class="lineNum">     411</span>              :            f_sice,      f_frzmlt   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L412"><span class="lineNum">     412</span>              :            f_fswfac,    f_fswint_ai, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L413"><span class="lineNum">     413</span>              :            f_fswabs,    f_fswabs_ai, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L414"><span class="lineNum">     414</span>              :            f_albsni,    &amp;   ! LCOV_EXCL_LINE</span>
<span id="L415"><span class="lineNum">     415</span>              :            f_alvdr,     f_alidr    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L416"><span class="lineNum">     416</span>              :            f_alvdf,     f_alidf    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L417"><span class="lineNum">     417</span>              :            f_alvdr_ai,  f_alidr_ai , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L418"><span class="lineNum">     418</span>              :            f_alvdf_ai,  f_alidf_ai , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L419"><span class="lineNum">     419</span>              :            f_albice,    f_albsno   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L420"><span class="lineNum">     420</span>              :            f_albpnd,    f_coszen   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L421"><span class="lineNum">     421</span>              :            f_flat,      f_flat_ai  , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L422"><span class="lineNum">     422</span>              :            f_fsens,     f_fsens_ai , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L423"><span class="lineNum">     423</span>              :            f_flwup,     f_flwup_ai , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L424"><span class="lineNum">     424</span>              :            f_evap,      f_evap_ai  , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L425"><span class="lineNum">     425</span>              :            f_Tair,      &amp;   ! LCOV_EXCL_LINE</span>
<span id="L426"><span class="lineNum">     426</span>              :            f_Tref,      f_Qref     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L427"><span class="lineNum">     427</span>              :            f_congel,    f_frazil   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L428"><span class="lineNum">     428</span>              :            f_snoice,    f_dsnow    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L429"><span class="lineNum">     429</span>              :            f_meltt,     f_melts    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L430"><span class="lineNum">     430</span>              :            f_meltb,     f_meltl    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L431"><span class="lineNum">     431</span>              :            f_fresh,     f_fresh_ai , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L432"><span class="lineNum">     432</span>              :            f_fsalt,     f_fsalt_ai , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L433"><span class="lineNum">     433</span>              :            f_fbot,      &amp;   ! LCOV_EXCL_LINE</span>
<span id="L434"><span class="lineNum">     434</span>              :            f_fhocn,     f_fhocn_ai , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L435"><span class="lineNum">     435</span>              :            f_fswthru,   f_fswthru_ai,&amp;   ! LCOV_EXCL_LINE</span>
<span id="L436"><span class="lineNum">     436</span>              :            f_strairx,   f_strairy  , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L437"><span class="lineNum">     437</span>              :            f_strtltx,   f_strtlty  , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L438"><span class="lineNum">     438</span>              :            f_strcorx,   f_strcory  , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L439"><span class="lineNum">     439</span>              :            f_strocnx,   f_strocny  , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L440"><span class="lineNum">     440</span>              :            f_strintx,   f_strinty  , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L441"><span class="lineNum">     441</span>              :            f_taubx,     f_tauby    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L442"><span class="lineNum">     442</span>              : !          f_strairxN,  f_strairyN , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L443"><span class="lineNum">     443</span>              : !          f_strtltxN,  f_strtltyN , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L444"><span class="lineNum">     444</span>              : !          f_strcorxN,  f_strcoryN , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L445"><span class="lineNum">     445</span>              : !          f_strocnxN,  f_strocnyN , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L446"><span class="lineNum">     446</span>              : !          f_strintxN,  f_strintyN , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L447"><span class="lineNum">     447</span>              : !          f_taubxN,    f_taubyN   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L448"><span class="lineNum">     448</span>              : !          f_strairxE,  f_strairyE , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L449"><span class="lineNum">     449</span>              : !          f_strtltxE,  f_strtltyE , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L450"><span class="lineNum">     450</span>              : !          f_strcorxE,  f_strcoryE , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L451"><span class="lineNum">     451</span>              : !          f_strocnxE,  f_strocnyE , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L452"><span class="lineNum">     452</span>              : !          f_strintxE,  f_strintyE , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L453"><span class="lineNum">     453</span>              : !          f_taubxE,    f_taubyE   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L454"><span class="lineNum">     454</span>              :            f_strength,  f_vort     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L455"><span class="lineNum">     455</span>              :            f_divu,      f_shear    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L456"><span class="lineNum">     456</span>              :            f_sig1,      f_sig2     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L457"><span class="lineNum">     457</span>              :            f_sigP,      &amp;   ! LCOV_EXCL_LINE</span>
<span id="L458"><span class="lineNum">     458</span>              :            f_dvidtt,    f_dvidtd   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L459"><span class="lineNum">     459</span>              :            f_daidtt,    f_daidtd   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L460"><span class="lineNum">     460</span>              :            f_dagedtt,   f_dagedtd  , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L461"><span class="lineNum">     461</span>              :            f_mlt_onset, f_frz_onset, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L462"><span class="lineNum">     462</span>              :            f_iage,      f_FY       , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L463"><span class="lineNum">     463</span>              :            f_hisnap,    f_aisnap   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L464"><span class="lineNum">     464</span>              :            f_CMIP, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L465"><span class="lineNum">     465</span>              :            f_sithick,   f_sisnthick, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L466"><span class="lineNum">     466</span>              :            f_siage,     &amp;   ! LCOV_EXCL_LINE</span>
<span id="L467"><span class="lineNum">     467</span>              :            f_sitemptop, f_sitempsnic,&amp;   ! LCOV_EXCL_LINE</span>
<span id="L468"><span class="lineNum">     468</span>              :            f_sitempbot, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L469"><span class="lineNum">     469</span>              :            f_sispeed,   f_sidir,     &amp;   ! LCOV_EXCL_LINE</span>
<span id="L470"><span class="lineNum">     470</span>              :            f_siu,       f_siv,       &amp;   ! LCOV_EXCL_LINE</span>
<span id="L471"><span class="lineNum">     471</span>              :            f_sidmasstranx, f_sidmasstrany, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L472"><span class="lineNum">     472</span>              :            f_sistrxdtop, f_sistrydtop, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L473"><span class="lineNum">     473</span>              :            f_sistrxubot, f_sistryubot, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L474"><span class="lineNum">     474</span>              :            f_sicompstren, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L475"><span class="lineNum">     475</span>              :            f_sialb, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L476"><span class="lineNum">     476</span>              :            f_sihc,      f_sisnhc,    &amp;   ! LCOV_EXCL_LINE</span>
<span id="L477"><span class="lineNum">     477</span>              :            f_sidconcth, f_sidconcdyn,&amp;   ! LCOV_EXCL_LINE</span>
<span id="L478"><span class="lineNum">     478</span>              :            f_sidmassth, f_sidmassdyn,&amp;   ! LCOV_EXCL_LINE</span>
<span id="L479"><span class="lineNum">     479</span>              :            f_sidmassgrowthwat, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L480"><span class="lineNum">     480</span>              :            f_sidmassgrowthbot, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L481"><span class="lineNum">     481</span>              :            f_sidmasssi, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L482"><span class="lineNum">     482</span>              :            f_sidmassevapsubl, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L483"><span class="lineNum">     483</span>              :            f_sndmasssubl, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L484"><span class="lineNum">     484</span>              :            f_sidmassmelttop, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L485"><span class="lineNum">     485</span>              :            f_sidmassmeltbot, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L486"><span class="lineNum">     486</span>              :            f_sidmasslat, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L487"><span class="lineNum">     487</span>              :            f_sndmasssnf, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L488"><span class="lineNum">     488</span>              :            f_sndmassmelt, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L489"><span class="lineNum">     489</span>              :            f_sndmassdyn, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L490"><span class="lineNum">     490</span>              :            f_siflswdtop, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L491"><span class="lineNum">     491</span>              :            f_siflswutop, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L492"><span class="lineNum">     492</span>              :            f_siflswdbot, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L493"><span class="lineNum">     493</span>              :            f_sifllwdtop, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L494"><span class="lineNum">     494</span>              :            f_sifllwutop, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L495"><span class="lineNum">     495</span>              :            f_siflsenstop, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L496"><span class="lineNum">     496</span>              :            f_siflsensupbot, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L497"><span class="lineNum">     497</span>              :            f_sifllatstop, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L498"><span class="lineNum">     498</span>              :            f_siflcondtop, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L499"><span class="lineNum">     499</span>              :            f_siflcondbot, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L500"><span class="lineNum">     500</span>              :            f_sipr, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L501"><span class="lineNum">     501</span>              :            f_sifb, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L502"><span class="lineNum">     502</span>              :            f_siflsaltbot, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L503"><span class="lineNum">     503</span>              :            f_siflfwbot, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L504"><span class="lineNum">     504</span>              :            f_siflfwdrain, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L505"><span class="lineNum">     505</span>              :            f_siforcetiltx, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L506"><span class="lineNum">     506</span>              :            f_siforcetilty, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L507"><span class="lineNum">     507</span>              :            f_siforcecoriolx, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L508"><span class="lineNum">     508</span>              :            f_siforcecorioly, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L509"><span class="lineNum">     509</span>              :            f_siforceintstrx, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L510"><span class="lineNum">     510</span>              :            f_siforceintstry, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L511"><span class="lineNum">     511</span>              :            f_siitdconc, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L512"><span class="lineNum">     512</span>              :            f_siitdthick, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L513"><span class="lineNum">     513</span>              :            f_siitdsnthick, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L514"><span class="lineNum">     514</span>              :            f_sidragtop, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L515"><span class="lineNum">     515</span>              :            f_sirdgthick, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L516"><span class="lineNum">     516</span>              :            f_sistreave, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L517"><span class="lineNum">     517</span>              :            f_sistremax, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L518"><span class="lineNum">     518</span>              :            f_aicen,     f_vicen    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L519"><span class="lineNum">     519</span>              :            f_vsnon,     &amp;   ! LCOV_EXCL_LINE</span>
<span id="L520"><span class="lineNum">     520</span>              :            f_trsig,     f_icepresent,&amp;   ! LCOV_EXCL_LINE</span>
<span id="L521"><span class="lineNum">     521</span>              :            f_fsurf_ai,  f_fcondtop_ai,&amp;   ! LCOV_EXCL_LINE</span>
<span id="L522"><span class="lineNum">     522</span>              :            f_fmeltt_ai, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L523"><span class="lineNum">     523</span>              :            f_fsurfn_ai,f_fcondtopn_ai,&amp;   ! LCOV_EXCL_LINE</span>
<span id="L524"><span class="lineNum">     524</span>              :            f_fmelttn_ai,f_flatn_ai,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L525"><span class="lineNum">     525</span>              :            f_fsensn_ai, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L526"><span class="lineNum">     526</span>              : !          f_field3dz,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L527"><span class="lineNum">     527</span>              :            f_keffn_top, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L528"><span class="lineNum">     528</span>              :            f_Tinz,      f_Sinz,      &amp;   ! LCOV_EXCL_LINE</span>
<span id="L529"><span class="lineNum">     529</span>              :            f_Tsnz,      &amp;   ! LCOV_EXCL_LINE</span>
<span id="L530"><span class="lineNum">     530</span>              :            f_a11,       f_a12,       &amp;   ! LCOV_EXCL_LINE</span>
<span id="L531"><span class="lineNum">     531</span>              :            f_e11,       f_e12,       &amp;   ! LCOV_EXCL_LINE</span>
<span id="L532"><span class="lineNum">     532</span>              :            f_e22,       &amp;   ! LCOV_EXCL_LINE</span>
<span id="L533"><span class="lineNum">     533</span>              :            f_s11,       f_s12,       &amp;   ! LCOV_EXCL_LINE</span>
<span id="L534"><span class="lineNum">     534</span>              :            f_s22,       &amp;   ! LCOV_EXCL_LINE</span>
<span id="L535"><span class="lineNum">     535</span>              :            f_yieldstress11, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L536"><span class="lineNum">     536</span>              :            f_yieldstress12, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L537"><span class="lineNum">     537</span>              :            f_yieldstress22</span>
<span id="L538"><span class="lineNum">     538</span>              : </span>
<span id="L539"><span class="lineNum">     539</span>              :       !---------------------------------------------------------------</span>
<span id="L540"><span class="lineNum">     540</span>              :       ! field indices</span>
<span id="L541"><span class="lineNum">     541</span>              :       !---------------------------------------------------------------</span>
<span id="L542"><span class="lineNum">     542</span>              : </span>
<span id="L543"><span class="lineNum">     543</span>              :       integer (kind=int_kind), parameter, public :: &amp;</span>
<span id="L544"><span class="lineNum">     544</span>              :            n_tlon       = 1,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L545"><span class="lineNum">     545</span>              :            n_tlat       = 2,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L546"><span class="lineNum">     546</span>              :            n_ulon       = 3,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L547"><span class="lineNum">     547</span>              :            n_ulat       = 4,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L548"><span class="lineNum">     548</span>              :            n_nlon       = 5,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L549"><span class="lineNum">     549</span>              :            n_nlat       = 6,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L550"><span class="lineNum">     550</span>              :            n_elon       = 7,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L551"><span class="lineNum">     551</span>              :            n_elat       = 8,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L552"><span class="lineNum">     552</span>              : </span>
<span id="L553"><span class="lineNum">     553</span>              :            n_tmask      = 1,  &amp;</span>
<span id="L554"><span class="lineNum">     554</span>              :            n_umask      = 2,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L555"><span class="lineNum">     555</span>              :            n_nmask      = 3,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L556"><span class="lineNum">     556</span>              :            n_emask      = 4,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L557"><span class="lineNum">     557</span>              :            n_blkmask    = 5,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L558"><span class="lineNum">     558</span>              :            n_tarea      = 6,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L559"><span class="lineNum">     559</span>              :            n_uarea      = 7,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L560"><span class="lineNum">     560</span>              :            n_narea      = 8,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L561"><span class="lineNum">     561</span>              :            n_earea      = 9,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L562"><span class="lineNum">     562</span>              :            n_dxt        = 10, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L563"><span class="lineNum">     563</span>              :            n_dyt        = 11, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L564"><span class="lineNum">     564</span>              :            n_dxu        = 12, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L565"><span class="lineNum">     565</span>              :            n_dyu        = 13, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L566"><span class="lineNum">     566</span>              :            n_dxn        = 14, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L567"><span class="lineNum">     567</span>              :            n_dyn        = 15, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L568"><span class="lineNum">     568</span>              :            n_dxe        = 16, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L569"><span class="lineNum">     569</span>              :            n_dye        = 17, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L570"><span class="lineNum">     570</span>              :            n_HTN        = 18, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L571"><span class="lineNum">     571</span>              :            n_HTE        = 19, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L572"><span class="lineNum">     572</span>              :            n_ANGLE      = 20, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L573"><span class="lineNum">     573</span>              :            n_ANGLET     = 21, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L574"><span class="lineNum">     574</span>              : </span>
<span id="L575"><span class="lineNum">     575</span>              :            n_NCAT       = 1, &amp;</span>
<span id="L576"><span class="lineNum">     576</span>              :            n_VGRDi      = 2, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L577"><span class="lineNum">     577</span>              :            n_VGRDs      = 3, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L578"><span class="lineNum">     578</span>              :            n_VGRDb      = 4, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L579"><span class="lineNum">     579</span>              :            n_VGRDa      = 5, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L580"><span class="lineNum">     580</span>              :            n_NFSD       = 6, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L581"><span class="lineNum">     581</span>              : </span>
<span id="L582"><span class="lineNum">     582</span>              :            n_lont_bnds  = 1, &amp;</span>
<span id="L583"><span class="lineNum">     583</span>              :            n_latt_bnds  = 2, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L584"><span class="lineNum">     584</span>              :            n_lonu_bnds  = 3, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L585"><span class="lineNum">     585</span>              :            n_latu_bnds  = 4, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L586"><span class="lineNum">     586</span>              :            n_lonn_bnds  = 5, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L587"><span class="lineNum">     587</span>              :            n_latn_bnds  = 6, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L588"><span class="lineNum">     588</span>              :            n_lone_bnds  = 7, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L589"><span class="lineNum">     589</span>              :            n_late_bnds  = 8</span>
<span id="L590"><span class="lineNum">     590</span>              : </span>
<span id="L591"><span class="lineNum">     591</span>              :       integer (kind=int_kind), dimension(max_nstrm), public :: &amp;</span>
<span id="L592"><span class="lineNum">     592</span>              : !          n_example    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L593"><span class="lineNum">     593</span>              :            n_hi         , n_hs         , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L594"><span class="lineNum">     594</span>              :            n_snowfrac   , n_snowfracn  , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L595"><span class="lineNum">     595</span>              :            n_Tsfc       , n_aice       , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L596"><span class="lineNum">     596</span>              :            n_uvel       , n_vvel       , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L597"><span class="lineNum">     597</span>              :            n_icespd     , n_icedir     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L598"><span class="lineNum">     598</span>              :            n_uvelE      , n_vvelE      , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L599"><span class="lineNum">     599</span>              :            n_icespdE    , n_icedirE    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L600"><span class="lineNum">     600</span>              :            n_uvelN      , n_vvelN      , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L601"><span class="lineNum">     601</span>              :            n_icespdN    , n_icedirN    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L602"><span class="lineNum">     602</span>              :            n_uatm       , n_vatm       , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L603"><span class="lineNum">     603</span>              :            n_atmspd     , n_atmdir     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L604"><span class="lineNum">     604</span>              :            n_sice       , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L605"><span class="lineNum">     605</span>              :            n_fswup      , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L606"><span class="lineNum">     606</span>              :            n_fswdn      , n_flwdn      , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L607"><span class="lineNum">     607</span>              :            n_snow       , n_snow_ai    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L608"><span class="lineNum">     608</span>              :            n_rain       , n_rain_ai    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L609"><span class="lineNum">     609</span>              :            n_sst        , n_sss        , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L610"><span class="lineNum">     610</span>              :            n_uocn       , n_vocn       , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L611"><span class="lineNum">     611</span>              :            n_ocnspd     , n_ocndir     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L612"><span class="lineNum">     612</span>              :            n_frzmlt     , n_fswfac     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L613"><span class="lineNum">     613</span>              :            n_fswint_ai  , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L614"><span class="lineNum">     614</span>              :            n_fswabs     , n_fswabs_ai  , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L615"><span class="lineNum">     615</span>              :            n_albsni     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L616"><span class="lineNum">     616</span>              :            n_alvdr      , n_alidr      , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L617"><span class="lineNum">     617</span>              :            n_alvdf      , n_alidf      , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L618"><span class="lineNum">     618</span>              :            n_alvdr_ai   , n_alidr_ai   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L619"><span class="lineNum">     619</span>              :            n_alvdf_ai   , n_alidf_ai   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L620"><span class="lineNum">     620</span>              :            n_albice     , n_albsno     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L621"><span class="lineNum">     621</span>              :            n_albpnd     , n_coszen     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L622"><span class="lineNum">     622</span>              :            n_flat       , n_flat_ai    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L623"><span class="lineNum">     623</span>              :            n_fsens      , n_fsens_ai   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L624"><span class="lineNum">     624</span>              :            n_flwup      , n_flwup_ai   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L625"><span class="lineNum">     625</span>              :            n_evap       , n_evap_ai    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L626"><span class="lineNum">     626</span>              :            n_Tair       , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L627"><span class="lineNum">     627</span>              :            n_Tref       , n_Qref       , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L628"><span class="lineNum">     628</span>              :            n_congel     , n_frazil     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L629"><span class="lineNum">     629</span>              :            n_snoice     , n_dsnow      , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L630"><span class="lineNum">     630</span>              :            n_meltt      , n_melts      , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L631"><span class="lineNum">     631</span>              :            n_meltb      , n_meltl      , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L632"><span class="lineNum">     632</span>              :            n_fresh      , n_fresh_ai   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L633"><span class="lineNum">     633</span>              :            n_fsalt      , n_fsalt_ai   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L634"><span class="lineNum">     634</span>              :            n_vsnon      , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L635"><span class="lineNum">     635</span>              :            n_fbot       , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L636"><span class="lineNum">     636</span>              :            n_fhocn      , n_fhocn_ai   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L637"><span class="lineNum">     637</span>              :            n_fswthru    , n_fswthru_ai , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L638"><span class="lineNum">     638</span>              :            n_strairx    , n_strairy    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L639"><span class="lineNum">     639</span>              :            n_strtltx    , n_strtlty    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L640"><span class="lineNum">     640</span>              :            n_strcorx    , n_strcory    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L641"><span class="lineNum">     641</span>              :            n_strocnx    , n_strocny    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L642"><span class="lineNum">     642</span>              :            n_strintx    , n_strinty    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L643"><span class="lineNum">     643</span>              :            n_taubx      , n_tauby      , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L644"><span class="lineNum">     644</span>              :            n_strairxN   , n_strairyN   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L645"><span class="lineNum">     645</span>              :            n_strtltxN   , n_strtltyN   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L646"><span class="lineNum">     646</span>              :            n_strcorxN   , n_strcoryN   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L647"><span class="lineNum">     647</span>              :            n_strocnxN   , n_strocnyN   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L648"><span class="lineNum">     648</span>              :            n_strintxN   , n_strintyN   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L649"><span class="lineNum">     649</span>              :            n_taubxN     , n_taubyN     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L650"><span class="lineNum">     650</span>              :            n_strairxE   , n_strairyE   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L651"><span class="lineNum">     651</span>              :            n_strtltxE   , n_strtltyE   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L652"><span class="lineNum">     652</span>              :            n_strcorxE   , n_strcoryE   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L653"><span class="lineNum">     653</span>              :            n_strocnxE   , n_strocnyE   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L654"><span class="lineNum">     654</span>              :            n_strintxE   , n_strintyE   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L655"><span class="lineNum">     655</span>              :            n_taubxE     , n_taubyE     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L656"><span class="lineNum">     656</span>              :            n_strength   , n_vort       , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L657"><span class="lineNum">     657</span>              :            n_divu       , n_shear      , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L658"><span class="lineNum">     658</span>              :            n_sig1       , n_sig2       , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L659"><span class="lineNum">     659</span>              :            n_sigP       , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L660"><span class="lineNum">     660</span>              :            n_dvidtt     , n_dvidtd     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L661"><span class="lineNum">     661</span>              :            n_daidtt     , n_daidtd     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L662"><span class="lineNum">     662</span>              :            n_dagedtt    , n_dagedtd    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L663"><span class="lineNum">     663</span>              :            n_mlt_onset  , n_frz_onset  , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L664"><span class="lineNum">     664</span>              :            n_hisnap     , n_aisnap     , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L665"><span class="lineNum">     665</span>              :            n_sithick    , n_sisnthick  , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L666"><span class="lineNum">     666</span>              :            n_siage,       &amp;   ! LCOV_EXCL_LINE</span>
<span id="L667"><span class="lineNum">     667</span>              :            n_sitemptop  , n_sitempsnic , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L668"><span class="lineNum">     668</span>              :            n_sitempbot  , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L669"><span class="lineNum">     669</span>              :            n_sispeed    , n_sidir      , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L670"><span class="lineNum">     670</span>              :            n_siu,         n_siv,         &amp;   ! LCOV_EXCL_LINE</span>
<span id="L671"><span class="lineNum">     671</span>              :            n_sidmasstranx, n_sidmasstrany, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L672"><span class="lineNum">     672</span>              :            n_sistrxdtop,  n_sistrydtop,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L673"><span class="lineNum">     673</span>              :            n_sistrxubot,  n_sistryubot,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L674"><span class="lineNum">     674</span>              :            n_sicompstren, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L675"><span class="lineNum">     675</span>              :            n_sialb, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L676"><span class="lineNum">     676</span>              :            n_sihc       , n_sisnhc,      &amp;   ! LCOV_EXCL_LINE</span>
<span id="L677"><span class="lineNum">     677</span>              :            n_sidconcth  , n_sidconcdyn,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L678"><span class="lineNum">     678</span>              :            n_sidmassth  , n_sidmassdyn,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L679"><span class="lineNum">     679</span>              :            n_sidmassgrowthwat,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L680"><span class="lineNum">     680</span>              :            n_sidmassgrowthbot,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L681"><span class="lineNum">     681</span>              :            n_sidmasssi,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L682"><span class="lineNum">     682</span>              :            n_sidmassevapsubl,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L683"><span class="lineNum">     683</span>              :            n_sndmasssubl,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L684"><span class="lineNum">     684</span>              :            n_sidmassmelttop,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L685"><span class="lineNum">     685</span>              :            n_sidmassmeltbot,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L686"><span class="lineNum">     686</span>              :            n_sidmasslat,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L687"><span class="lineNum">     687</span>              :            n_sndmasssnf,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L688"><span class="lineNum">     688</span>              :            n_sndmassmelt,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L689"><span class="lineNum">     689</span>              :            n_sndmassdyn,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L690"><span class="lineNum">     690</span>              :            n_siflswdtop,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L691"><span class="lineNum">     691</span>              :            n_siflswutop,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L692"><span class="lineNum">     692</span>              :            n_siflswdbot,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L693"><span class="lineNum">     693</span>              :            n_sifllwdtop,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L694"><span class="lineNum">     694</span>              :            n_sifllwutop,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L695"><span class="lineNum">     695</span>              :            n_siflsenstop,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L696"><span class="lineNum">     696</span>              :            n_siflsensupbot,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L697"><span class="lineNum">     697</span>              :            n_sifllatstop,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L698"><span class="lineNum">     698</span>              :            n_siflcondtop,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L699"><span class="lineNum">     699</span>              :            n_siflcondbot,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L700"><span class="lineNum">     700</span>              :            n_sipr,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L701"><span class="lineNum">     701</span>              :            n_sifb,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L702"><span class="lineNum">     702</span>              :            n_siflsaltbot,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L703"><span class="lineNum">     703</span>              :            n_siflfwbot,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L704"><span class="lineNum">     704</span>              :            n_siflfwdrain,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L705"><span class="lineNum">     705</span>              :            n_siforcetiltx,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L706"><span class="lineNum">     706</span>              :            n_siforcetilty,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L707"><span class="lineNum">     707</span>              :            n_siforcecoriolx,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L708"><span class="lineNum">     708</span>              :            n_siforcecorioly,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L709"><span class="lineNum">     709</span>              :            n_siforceintstrx,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L710"><span class="lineNum">     710</span>              :            n_siforceintstry,  &amp;   ! LCOV_EXCL_LINE</span>
<span id="L711"><span class="lineNum">     711</span>              :            n_siitdconc, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L712"><span class="lineNum">     712</span>              :            n_siitdthick, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L713"><span class="lineNum">     713</span>              :            n_siitdsnthick, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L714"><span class="lineNum">     714</span>              :            n_sidragtop, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L715"><span class="lineNum">     715</span>              :            n_sirdgthick, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L716"><span class="lineNum">     716</span>              :            n_sistreave, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L717"><span class="lineNum">     717</span>              :            n_sistremax, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L718"><span class="lineNum">     718</span>              :            n_trsig      , n_icepresent , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L719"><span class="lineNum">     719</span>              :            n_iage       , n_FY         , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L720"><span class="lineNum">     720</span>              :            n_fsurf_ai   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L721"><span class="lineNum">     721</span>              :            n_fcondtop_ai, n_fmeltt_ai  , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L722"><span class="lineNum">     722</span>              :            n_aicen      , n_vicen      , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L723"><span class="lineNum">     723</span>              :            n_fsurfn_ai   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L724"><span class="lineNum">     724</span>              :            n_fcondtopn_ai, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L725"><span class="lineNum">     725</span>              :            n_fmelttn_ai  , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L726"><span class="lineNum">     726</span>              :            n_flatn_ai    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L727"><span class="lineNum">     727</span>              :            n_fsensn_ai   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L728"><span class="lineNum">     728</span>              : !          n_field3dz    , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L729"><span class="lineNum">     729</span>              :            n_keffn_top   , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L730"><span class="lineNum">     730</span>              :            n_Tinz        , n_Sinz      , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L731"><span class="lineNum">     731</span>              :            n_Tsnz        , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L732"><span class="lineNum">     732</span>              :            n_a11         , n_a12       , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L733"><span class="lineNum">     733</span>              :            n_e11         , n_e12       , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L734"><span class="lineNum">     734</span>              :            n_e22         , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L735"><span class="lineNum">     735</span>              :            n_s11         , n_s12       , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L736"><span class="lineNum">     736</span>              :            n_s22         , &amp;   ! LCOV_EXCL_LINE</span>
<span id="L737"><span class="lineNum">     737</span>              :            n_yieldstress11, n_yieldstress12, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L738"><span class="lineNum">     738</span>              :            n_yieldstress22</span>
<span id="L739"><span class="lineNum">     739</span>              : </span>
<span id="L740"><span class="lineNum">     740</span>              :       interface accum_hist_field ! generic interface</span>
<span id="L741"><span class="lineNum">     741</span>              :            module procedure accum_hist_field_2D, &amp;</span>
<span id="L742"><span class="lineNum">     742</span>              :                             accum_hist_field_3D, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L743"><span class="lineNum">     743</span>              :                             accum_hist_field_4D</span>
<span id="L744"><span class="lineNum">     744</span>              :       end interface</span>
<span id="L745"><span class="lineNum">     745</span>              : </span>
<span id="L746"><span class="lineNum">     746</span>              : !=======================================================================</span>
<span id="L747"><span class="lineNum">     747</span>              : </span>
<span id="L748"><span class="lineNum">     748</span>              :       contains</span>
<span id="L749"><span class="lineNum">     749</span>              : </span>
<span id="L750"><span class="lineNum">     750</span>              : !=======================================================================</span>
<span id="L751"><span class="lineNum">     751</span>              : </span>
<span id="L752"><span class="lineNum">     752</span> <span class="tlaGNC tlaBgGNC">          18 :       subroutine construct_filename(ncfile,suffix,ns)</span></span>
<span id="L753"><span class="lineNum">     753</span>              : </span>
<span id="L754"><span class="lineNum">     754</span>              :       use ice_calendar, only: msec, myear, mmonth, daymo,  &amp;</span>
<span id="L755"><span class="lineNum">     755</span>              :                               mday, write_ic, histfreq, histfreq_n, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L756"><span class="lineNum">     756</span>              :                               new_year, new_month, new_day, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L757"><span class="lineNum">     757</span>              :                               dt</span>
<span id="L758"><span class="lineNum">     758</span>              :       use ice_restart_shared, only: lenstr</span>
<span id="L759"><span class="lineNum">     759</span>              : </span>
<span id="L760"><span class="lineNum">     760</span>              :       character (len=*), intent(inout) :: ncfile</span>
<span id="L761"><span class="lineNum">     761</span>              :       character (len=*), intent(in) :: suffix</span>
<span id="L762"><span class="lineNum">     762</span>              :       integer (kind=int_kind), intent(in) :: ns</span>
<span id="L763"><span class="lineNum">     763</span>              : </span>
<span id="L764"><span class="lineNum">     764</span>              :       integer (kind=int_kind) :: iyear, imonth, iday, isec</span>
<span id="L765"><span class="lineNum">     765</span>              :       integer (kind=int_kind) :: n</span>
<span id="L766"><span class="lineNum">     766</span>              :       character (len=char_len) :: cstream</span>
<span id="L767"><span class="lineNum">     767</span>              :       character (len=char_len_long), save :: ncfile_last(max_nstrm) = 'UnDefineD'</span>
<span id="L768"><span class="lineNum">     768</span>              :       character(len=*), parameter :: subname = '(construct_filename)'</span>
<span id="L769"><span class="lineNum">     769</span>              : </span>
<span id="L770"><span class="lineNum">     770</span> <span class="tlaGNC">          18 :         iyear = myear</span></span>
<span id="L771"><span class="lineNum">     771</span> <span class="tlaGNC">          18 :         imonth = mmonth</span></span>
<span id="L772"><span class="lineNum">     772</span> <span class="tlaGNC">          18 :         iday = mday</span></span>
<span id="L773"><span class="lineNum">     773</span> <span class="tlaGNC">          18 :         isec = int(msec - dt,int_kind)</span></span>
<span id="L774"><span class="lineNum">     774</span> <span class="tlaGNC">          18 :         cstream = ''</span></span>
<span id="L775"><span class="lineNum">     775</span> <span class="tlaGNC">           2 :         if (hist_suffix(ns) /= 'x') cstream = hist_suffix(ns)</span></span>
<span id="L776"><span class="lineNum">     776</span>              : </span>
<span id="L777"><span class="lineNum">     777</span>              :         ! construct filename</span>
<span id="L778"><span class="lineNum">     778</span> <span class="tlaGNC">          18 :         if (write_ic) then</span></span>
<span id="L779"><span class="lineNum">     779</span> <span class="tlaGNC">           7 :            isec = msec</span></span>
<span id="L780"><span class="lineNum">     780</span>              :            write(ncfile,'(a,a,i4.4,a,i2.2,a,i2.2,a,i5.5,a,a)')  &amp;</span>
<span id="L781"><span class="lineNum">     781</span> <span class="tlaGNC">           7 :               incond_file(1:lenstr(incond_file)),'.',iyear,'-', &amp;   ! LCOV_EXCL_LINE</span></span>
<span id="L782"><span class="lineNum">     782</span> <span class="tlaGNC">          14 :               imonth,'-',iday,'-',isec,'.',trim(suffix)</span></span>
<span id="L783"><span class="lineNum">     783</span>              :         else</span>
<span id="L784"><span class="lineNum">     784</span>              : </span>
<span id="L785"><span class="lineNum">     785</span> <span class="tlaGNC">          11 :            if (hist_avg(ns)) then</span></span>
<span id="L786"><span class="lineNum">     786</span> <span class="tlaGNC">          11 :               if (histfreq(ns) == '1' .or. histfreq(ns) == 'h'.or.histfreq(ns) == 'H') then</span></span>
<span id="L787"><span class="lineNum">     787</span>              :                  ! do nothing</span>
<span id="L788"><span class="lineNum">     788</span> <span class="tlaGNC">          11 :               elseif (new_year) then</span></span>
<span id="L789"><span class="lineNum">     789</span> <span class="tlaUNC tlaBgUNC">           0 :                  iyear = iyear - 1</span></span>
<span id="L790"><span class="lineNum">     790</span> <span class="tlaUNC">           0 :                  imonth = 12</span></span>
<span id="L791"><span class="lineNum">     791</span> <span class="tlaUNC">           0 :                  iday = daymo(imonth)</span></span>
<span id="L792"><span class="lineNum">     792</span> <span class="tlaGNC tlaBgGNC">          11 :               elseif (new_month) then</span></span>
<span id="L793"><span class="lineNum">     793</span> <span class="tlaUNC tlaBgUNC">           0 :                  imonth = mmonth - 1</span></span>
<span id="L794"><span class="lineNum">     794</span> <span class="tlaUNC">           0 :                  iday = daymo(imonth)</span></span>
<span id="L795"><span class="lineNum">     795</span> <span class="tlaGNC tlaBgGNC">          11 :               elseif (new_day) then</span></span>
<span id="L796"><span class="lineNum">     796</span> <span class="tlaGNC">          11 :                  iday = iday - 1</span></span>
<span id="L797"><span class="lineNum">     797</span>              :               endif</span>
<span id="L798"><span class="lineNum">     798</span>              :            endif</span>
<span id="L799"><span class="lineNum">     799</span>              : </span>
<span id="L800"><span class="lineNum">     800</span> <span class="tlaGNC">          11 :            if (hist_avg(ns)) then    ! write averaged data</span></span>
<span id="L801"><span class="lineNum">     801</span> <span class="tlaGNC">          11 :               if (histfreq(ns) == '1' .and. histfreq_n(ns) == 1)  then ! timestep</span></span>
<span id="L802"><span class="lineNum">     802</span>              :                  write(ncfile,'(a,a,i4.4,a,i2.2,a,i2.2,a,i5.5,a,a)')  &amp;</span>
<span id="L803"><span class="lineNum">     803</span> <span class="tlaUNC tlaBgUNC">           0 :                        history_file(1:lenstr(history_file))//trim(cstream),'_inst.', &amp;   ! LCOV_EXCL_LINE</span></span>
<span id="L804"><span class="lineNum">     804</span> <span class="tlaUNC">           0 :                        iyear,'-',imonth,'-',iday,'-',msec,'.',trim(suffix)</span></span>
<span id="L805"><span class="lineNum">     805</span> <span class="tlaGNC tlaBgGNC">          11 :               elseif (histfreq(ns) == '1' .and. histfreq_n(ns) &gt; 1)  then ! timestep</span></span>
<span id="L806"><span class="lineNum">     806</span>              :                  write(ncfile,'(a,a,i4.4,a,i2.2,a,i2.2,a,i5.5,a,a)')  &amp;</span>
<span id="L807"><span class="lineNum">     807</span> <span class="tlaUNC tlaBgUNC">           0 :                        history_file(1:lenstr(history_file))//trim(cstream),'.', &amp;   ! LCOV_EXCL_LINE</span></span>
<span id="L808"><span class="lineNum">     808</span> <span class="tlaUNC">           0 :                        iyear,'-',imonth,'-',iday,'-',msec,'.',trim(suffix)</span></span>
<span id="L809"><span class="lineNum">     809</span> <span class="tlaGNC tlaBgGNC">          11 :               elseif (histfreq(ns) == 'h'.or.histfreq(ns) == 'H') then ! hourly</span></span>
<span id="L810"><span class="lineNum">     810</span>              :                  write(ncfile,'(a,a,i2.2,a,i4.4,a,i2.2,a,i2.2,a,i5.5,a,a)')  &amp;</span>
<span id="L811"><span class="lineNum">     811</span> <span class="tlaUNC tlaBgUNC">           0 :                        history_file(1:lenstr(history_file))//trim(cstream),'_', &amp;   ! LCOV_EXCL_LINE</span></span>
<span id="L812"><span class="lineNum">     812</span> <span class="tlaUNC">           0 :                        histfreq_n(ns),'h.',iyear,'-',imonth,'-',iday,'-',msec,'.',trim(suffix)</span></span>
<span id="L813"><span class="lineNum">     813</span> <span class="tlaGNC tlaBgGNC">          11 :               elseif (histfreq(ns) == 'd'.or.histfreq(ns) == 'D') then ! daily</span></span>
<span id="L814"><span class="lineNum">     814</span>              :                  write(ncfile,'(a,a,i4.4,a,i2.2,a,i2.2,a,a)')  &amp;</span>
<span id="L815"><span class="lineNum">     815</span> <span class="tlaGNC">          11 :                        history_file(1:lenstr(history_file))//trim(cstream),'.', &amp;   ! LCOV_EXCL_LINE</span></span>
<span id="L816"><span class="lineNum">     816</span> <span class="tlaGNC">          22 :                        iyear,'-',imonth,'-',iday,'.',trim(suffix)</span></span>
<span id="L817"><span class="lineNum">     817</span> <span class="tlaUNC tlaBgUNC">           0 :               elseif (histfreq(ns) == 'm'.or.histfreq(ns) == 'M') then ! monthly</span></span>
<span id="L818"><span class="lineNum">     818</span>              :                  write(ncfile,'(a,a,i4.4,a,i2.2,a,a)')  &amp;</span>
<span id="L819"><span class="lineNum">     819</span> <span class="tlaUNC">           0 :                        history_file(1:lenstr(history_file))//trim(cstream),'.', &amp;   ! LCOV_EXCL_LINE</span></span>
<span id="L820"><span class="lineNum">     820</span> <span class="tlaUNC">           0 :                        iyear,'-',imonth,'.',trim(suffix)</span></span>
<span id="L821"><span class="lineNum">     821</span> <span class="tlaUNC">           0 :               elseif (histfreq(ns) == 'y'.or.histfreq(ns) == 'Y') then ! yearly</span></span>
<span id="L822"><span class="lineNum">     822</span>              :                  write(ncfile,'(a,a,i4.4,a,a)') &amp;</span>
<span id="L823"><span class="lineNum">     823</span> <span class="tlaUNC">           0 :                        history_file(1:lenstr(history_file))//trim(cstream),'.', &amp;   ! LCOV_EXCL_LINE</span></span>
<span id="L824"><span class="lineNum">     824</span> <span class="tlaUNC">           0 :                        iyear,'.',trim(suffix)</span></span>
<span id="L825"><span class="lineNum">     825</span>              :               endif</span>
<span id="L826"><span class="lineNum">     826</span>              : </span>
<span id="L827"><span class="lineNum">     827</span>              :            else                     ! instantaneous</span>
<span id="L828"><span class="lineNum">     828</span>              :               write(ncfile,'(a,a,i4.4,a,i2.2,a,i2.2,a,i5.5,a,a)')  &amp;</span>
<span id="L829"><span class="lineNum">     829</span> <span class="tlaUNC">           0 :                     history_file(1:lenstr(history_file))//trim(cstream),'_inst.', &amp;   ! LCOV_EXCL_LINE</span></span>
<span id="L830"><span class="lineNum">     830</span> <span class="tlaUNC">           0 :                     iyear,'-',imonth,'-',iday,'-',msec,'.',trim(suffix)</span></span>
<span id="L831"><span class="lineNum">     831</span>              :            endif</span>
<span id="L832"><span class="lineNum">     832</span>              : </span>
<span id="L833"><span class="lineNum">     833</span>              :         endif</span>
<span id="L834"><span class="lineNum">     834</span>              : </span>
<span id="L835"><span class="lineNum">     835</span>              :         ! Check whether the filename is already in use.</span>
<span id="L836"><span class="lineNum">     836</span>              :         ! Same filename in multiple history streams leads to files being overwritten (not good).</span>
<span id="L837"><span class="lineNum">     837</span>              :         ! The current filename convention means we just have to check latest filename,</span>
<span id="L838"><span class="lineNum">     838</span>              :         ! not all filenames ever generated because of use of current model date/time in filename.</span>
<span id="L839"><span class="lineNum">     839</span>              : </span>
<span id="L840"><span class="lineNum">     840</span>              :         ! write(nu_diag,'(2a,i2,1x,a)') subname, 'debug ncfile= ',ns,trim(ncfile)</span>
<span id="L841"><span class="lineNum">     841</span> <span class="tlaGNC tlaBgGNC">         108 :         do n = 1,max_nstrm</span></span>
<span id="L842"><span class="lineNum">     842</span>              :            ! write(nu_diag,'(2a,i2,1x,a)') subname, 'debug nfile_last= ',n,trim(ncfile_last(n))</span>
<span id="L843"><span class="lineNum">     843</span> <span class="tlaGNC">         108 :            if (ncfile == ncfile_last(n)) then</span></span>
<span id="L844"><span class="lineNum">     844</span> <span class="tlaUNC tlaBgUNC">           0 :               write(nu_diag,*) subname,' history stream = ',ns</span></span>
<span id="L845"><span class="lineNum">     845</span> <span class="tlaUNC">           0 :               write(nu_diag,*) subname,' history filename = ',trim(ncfile)</span></span>
<span id="L846"><span class="lineNum">     846</span> <span class="tlaUNC">           0 :               write(nu_diag,*) subname,' filename in use for stream ',n</span></span>
<span id="L847"><span class="lineNum">     847</span> <span class="tlaUNC">           0 :               write(nu_diag,*) subname,' filename for stream ',trim(ncfile_last(n))</span></span>
<span id="L848"><span class="lineNum">     848</span> <span class="tlaUNC">           0 :               write(nu_diag,*) subname,' Use namelist hist_suffix so history filenames are unique'</span></span>
<span id="L849"><span class="lineNum">     849</span> <span class="tlaUNC">           0 :               call abort_ice(subname//' ERROR: history filename already used for another history stream '//trim(ncfile))</span></span>
<span id="L850"><span class="lineNum">     850</span>              :            endif</span>
<span id="L851"><span class="lineNum">     851</span>              :         enddo</span>
<span id="L852"><span class="lineNum">     852</span> <span class="tlaGNC tlaBgGNC">          18 :         ncfile_last(ns) = ncfile</span></span>
<span id="L853"><span class="lineNum">     853</span>              : </span>
<span id="L854"><span class="lineNum">     854</span> <span class="tlaGNC">          18 :       end subroutine construct_filename</span></span>
<span id="L855"><span class="lineNum">     855</span>              : </span>
<span id="L856"><span class="lineNum">     856</span>              : !=======================================================================</span>
<span id="L857"><span class="lineNum">     857</span>              : </span>
<span id="L858"><span class="lineNum">     858</span>              : !     Initializes description of an available field and returns location</span>
<span id="L859"><span class="lineNum">     859</span>              : !     in the available fields array for use in later calls.</span>
<span id="L860"><span class="lineNum">     860</span>              : !</span>
<span id="L861"><span class="lineNum">     861</span>              : !     2009 Created by D. Bailey following POP</span>
<span id="L862"><span class="lineNum">     862</span>              : </span>
<span id="L863"><span class="lineNum">     863</span> <span class="tlaGNC">        8880 :       subroutine define_hist_field(id, vname, vunit, vcoord, vcellmeas, &amp;</span></span>
<span id="L864"><span class="lineNum">     864</span>              :                                    vdesc, vcomment, cona, conb, &amp;   ! LCOV_EXCL_LINE</span>
<span id="L865"><span class="lineNum">     865</span>              :                                    ns, vhistfreq, avg_ice_present, mask_ice_free_points)</span>
<span id="L866"><span class="lineNum">     866</span>              : </span>
<span id="L867"><span class="lineNum">     867</span>              :       use ice_calendar, only: histfreq, histfreq_n</span>
<span id="L868"><span class="lineNum">     868</span>              : </span>
<span id="L869"><span class="lineNum">     869</span>              :       integer (int_kind), dimension(:), intent(out) :: &amp;  ! max_nstrm</span>
<span id="L870"><span class="lineNum">     870</span>              :          id                ! location in avail_fields array for use in</span>
<span id="L871"><span class="lineNum">     871</span>              :                            ! later routines</span>
<span id="L872"><span class="lineNum">     872</span>              : </span>
<span id="L873"><span class="lineNum">     873</span>              :       character (len=*), intent(in) :: &amp;</span>
<span id="L874"><span class="lineNum">     874</span>              :          vname      , &amp; ! variable names   ! LCOV_EXCL_LINE</span>
<span id="L875"><span class="lineNum">     875</span>              :          vunit      , &amp; ! variable units   ! LCOV_EXCL_LINE</span>
<span id="L876"><span class="lineNum">     876</span>              :          vcoord     , &amp; ! variable coordinates   ! LCOV_EXCL_LINE</span>
<span id="L877"><span class="lineNum">     877</span>              :          vcellmeas  , &amp; ! variables cell measures   ! LCOV_EXCL_LINE</span>
<span id="L878"><span class="lineNum">     878</span>              :          vdesc      , &amp; ! variable descriptions   ! LCOV_EXCL_LINE</span>
<span id="L879"><span class="lineNum">     879</span>              :          vcomment       ! variable comments</span>
<span id="L880"><span class="lineNum">     880</span>              : </span>
<span id="L881"><span class="lineNum">     881</span>              :       real (kind=dbl_kind), intent(in) :: &amp;</span>
<span id="L882"><span class="lineNum">     882</span>              :          cona       , &amp; ! multiplicative conversion factor   ! LCOV_EXCL_LINE</span>
<span id="L883"><span class="lineNum">     883</span>              :          conb           ! additive conversion factor</span>
<span id="L884"><span class="lineNum">     884</span>              : </span>
<span id="L885"><span class="lineNum">     885</span>              :       character (len=*), intent(in) :: &amp;</span>
<span id="L886"><span class="lineNum">     886</span>              :          vhistfreq      ! history frequency</span>
<span id="L887"><span class="lineNum">     887</span>              : </span>
<span id="L888"><span class="lineNum">     888</span>              :       integer (kind=int_kind), intent(in) :: &amp;</span>
<span id="L889"><span class="lineNum">     889</span>              :          ns             ! history file stream index</span>
<span id="L890"><span class="lineNum">     890</span>              : </span>
<span id="L891"><span class="lineNum">     891</span>              :       logical (kind=log_kind), optional, intent(in) :: &amp;</span>
<span id="L892"><span class="lineNum">     892</span>              :          avg_ice_present       , &amp; ! compute average only when ice is present   ! LCOV_EXCL_LINE</span>
<span id="L893"><span class="lineNum">     893</span>              :          mask_ice_free_points      ! mask ice-free points</span>
<span id="L894"><span class="lineNum">     894</span>              : </span>
<span id="L895"><span class="lineNum">     895</span>              :       integer (kind=int_kind) :: &amp;</span>
<span id="L896"><span class="lineNum">     896</span>              :          ns1        , &amp; ! variable stream loop index   ! LCOV_EXCL_LINE</span>
<span id="L897"><span class="lineNum">     897</span>              :          lenf           ! length of namelist string</span>
<span id="L898"><span class="lineNum">     898</span>              : </span>
<span id="L899"><span class="lineNum">     899</span>              :       character (len=40) :: stmp</span>
<span id="L900"><span class="lineNum">     900</span>              : </span>
<span id="L901"><span class="lineNum">     901</span>              :       logical (kind=log_kind) :: &amp;</span>
<span id="L902"><span class="lineNum">     902</span>              :          l_avg_ice_present       , &amp; ! compute average only when ice is present   ! LCOV_EXCL_LINE</span>
<span id="L903"><span class="lineNum">     903</span>              :          l_mask_ice_free_points      ! mask ice-free points</span>
<span id="L904"><span class="lineNum">     904</span>              : </span>
<span id="L905"><span class="lineNum">     905</span>              :       character(len=*), parameter :: subname = '(define_hist_field)'</span>
<span id="L906"><span class="lineNum">     906</span>              : </span>
<span id="L907"><span class="lineNum">     907</span> <span class="tlaGNC">        8880 :       l_avg_ice_present = .false.</span></span>
<span id="L908"><span class="lineNum">     908</span> <span class="tlaGNC">        8880 :       l_mask_ice_free_points = .false.</span></span>
<span id="L909"><span class="lineNum">     909</span>              : </span>
<span id="L910"><span class="lineNum">     910</span> <span class="tlaGNC">        8880 :       if(present(avg_ice_present)) l_avg_ice_present = avg_ice_present</span></span>
<span id="L911"><span class="lineNum">     911</span> <span class="tlaGNC">        8880 :       if(present(mask_ice_free_points)) l_mask_ice_free_points = mask_ice_free_points</span></span>
<span id="L912"><span class="lineNum">     912</span>              : </span>
<span id="L913"><span class="lineNum">     913</span> <span class="tlaGNC">        8880 :       if (histfreq(ns) == 'x') then</span></span>
<span id="L914"><span class="lineNum">     914</span> <span class="tlaUNC tlaBgUNC">           0 :          call abort_ice(subname//' ERROR: define_hist_fields has histfreq x')</span></span>
<span id="L915"><span class="lineNum">     915</span>              :       endif</span>
<span id="L916"><span class="lineNum">     916</span>              : </span>
<span id="L917"><span class="lineNum">     917</span> <span class="tlaGNC tlaBgGNC">       53280 :       if (ns == 1) id(:) = 0</span></span>
<span id="L918"><span class="lineNum">     918</span> <span class="tlaGNC">        8880 :       lenf = len(trim(vhistfreq))</span></span>
<span id="L919"><span class="lineNum">     919</span>              : </span>
<span id="L920"><span class="lineNum">     920</span> <span class="tlaGNC">       17760 :       do ns1 = 1, lenf</span></span>
<span id="L921"><span class="lineNum">     921</span> <span class="tlaGNC">       17760 :          if (vhistfreq(ns1:ns1) == histfreq(ns)) then</span></span>
<span id="L922"><span class="lineNum">     922</span>              : </span>
<span id="L923"><span class="lineNum">     923</span> <span class="tlaGNC">        1837 :             if (ns1 &gt; 1 .and. index(vhistfreq(1:ns1-1),'x') /= 0) then</span></span>
<span id="L924"><span class="lineNum">     924</span> <span class="tlaUNC tlaBgUNC">           0 :                call abort_ice(subname//' ERROR: history frequency variable f_' // vname // ' can''t contain ''x'' along with active frequencies')</span></span>
<span id="L925"><span class="lineNum">     925</span>              :             endif</span>
<span id="L926"><span class="lineNum">     926</span>              : </span>
<span id="L927"><span class="lineNum">     927</span> <span class="tlaGNC tlaBgGNC">        1837 :             num_avail_hist_fields_tot = num_avail_hist_fields_tot + 1</span></span>
<span id="L928"><span class="lineNum">     928</span>              : </span>
<span id="L929"><span class="lineNum">     929</span> <span class="tlaGNC">        1837 :             if (vcoord(11:14) == 'time') then</span></span>
<span id="L930"><span class="lineNum">     930</span> <span class="tlaGNC">        1837 :                num_avail_hist_fields_2D  = num_avail_hist_fields_2D + 1</span></span>
<span id="L931"><span class="lineNum">     931</span> <span class="tlaUNC tlaBgUNC">           0 :             elseif (vcoord(11:14) == 'NCAT' .and. vcoord(17:20) == 'time') then</span></span>
<span id="L932"><span class="lineNum">     932</span> <span class="tlaUNC">           0 :                num_avail_hist_fields_3Dc = num_avail_hist_fields_3Dc + 1</span></span>
<span id="L933"><span class="lineNum">     933</span> <span class="tlaUNC">           0 :             elseif (vcoord(11:14) == 'NFSD' .and. vcoord(17:20) == 'time') then</span></span>
<span id="L934"><span class="lineNum">     934</span> <span class="tlaUNC">           0 :                num_avail_hist_fields_3Df = num_avail_hist_fields_3Df + 1</span></span>
<span id="L935"><span class="lineNum">     935</span> <span class="tlaUNC">           0 :             elseif (vcoord(11:15) == 'VGRDi' .and. vcoord(17:20) == 'time') then</span></span>
<span id="L936"><span class="lineNum">     936</span> <span class="tlaUNC">           0 :                num_avail_hist_fields_3Dz = num_avail_hist_fields_3Dz + 1</span></span>
<span id="L937"><span class="lineNum">     937</span> <span class="tlaUNC">           0 :             elseif (vcoord(11:15) == 'VGRDb' .and. vcoord(17:20) == 'time') then</span></span>
<span id="L938"><span class="lineNum">     938</span> <span class="tlaUNC">           0 :                num_avail_hist_fields_3Db = num_avail_hist_fields_3Db + 1</span></span>
<span id="L939"><span class="lineNum">     939</span> <span class="tlaUNC">           0 :             elseif (vcoord(11:15) == 'VGRDa' .and. vcoord(17:20) == 'time') then</span></span>
<span id="L940"><span class="lineNum">     940</span> <span class="tlaUNC">           0 :                num_avail_hist_fields_3Da = num_avail_hist_fields_3Da + 1</span></span>
<span id="L941"><span class="lineNum">     941</span> <span class="tlaUNC">           0 :             elseif (vcoord(11:15) == 'VGRDi' .and. vcoord(17:20) == 'NCAT') then</span></span>
<span id="L942"><span class="lineNum">     942</span> <span class="tlaUNC">           0 :                num_avail_hist_fields_4Di = num_avail_hist_fields_4Di + 1</span></span>
<span id="L943"><span class="lineNum">     943</span> <span class="tlaUNC">           0 :             elseif (vcoord(11:15) == 'VGRDs' .and. vcoord(17:20) == 'NCAT') then</span></span>
<span id="L944"><span class="lineNum">     944</span> <span class="tlaUNC">           0 :                num_avail_hist_fields_4Ds = num_avail_hist_fields_4Ds + 1</span></span>
<span id="L945"><span class="lineNum">     945</span> <span class="tlaUNC">           0 :             elseif (vcoord(11:14) == 'NFSD' .and. vcoord(17:20) == 'NCAT') then</span></span>
<span id="L946"><span class="lineNum">     946</span> <span class="tlaUNC">           0 :                num_avail_hist_fields_4Df = num_avail_hist_fields_4Df + 1</span></span>
<span id="L947"><span class="lineNum">     947</span>              :             endif</span>
<span id="L948"><span class="lineNum">     948</span>              : </span>
<span id="L949"><span class="lineNum">     949</span> <span class="tlaGNC tlaBgGNC">        1837 :             if (num_avail_hist_fields_tot &gt; max_avail_hist_fields) then</span></span>
<span id="L950"><span class="lineNum">     950</span> <span class="tlaUNC tlaBgUNC">           0 :                if (my_task == master_task) then</span></span>
<span id="L951"><span class="lineNum">     951</span> <span class="tlaUNC">           0 :                   write(nu_diag,*) subname,' num_avail_hist_fields_tot = ',num_avail_hist_fields_tot</span></span>
<span id="L952"><span class="lineNum">     952</span> <span class="tlaUNC">           0 :                   write(nu_diag,*) subname,' max_avail_hist_fields     = ',max_avail_hist_fields</span></span>
<span id="L953"><span class="lineNum">     953</span>              :                endif</span>
<span id="L954"><span class="lineNum">     954</span> <span class="tlaUNC">           0 :                call abort_ice(subname//' ERROR: Need in computation of max_avail_hist_fields')</span></span>
<span id="L955"><span class="lineNum">     955</span>              :             endif</span>
<span id="L956"><span class="lineNum">     956</span>              : </span>
<span id="L957"><span class="lineNum">     957</span> <span class="tlaGNC tlaBgGNC">        1837 :             if (num_avail_hist_fields_tot /= &amp;</span></span>
<span id="L958"><span class="lineNum">     958</span>              :                 num_avail_hist_fields_2D  + &amp;   ! LCOV_EXCL_LINE</span>
<span id="L959"><span class="lineNum">     959</span>              :                 num_avail_hist_fields_3Dc + &amp;   ! LCOV_EXCL_LINE</span>
<span id="L960"><span class="lineNum">     960</span>              :                 num_avail_hist_fields_3Dz + &amp;   ! LCOV_EXCL_LINE</span>
<span id="L961"><span class="lineNum">     961</span>              :                 num_avail_hist_fields_3Db + &amp;   ! LCOV_EXCL_LINE</span>
<span id="L962"><span class="lineNum">     962</span>              :                 num_avail_hist_fields_3Da + &amp;   ! LCOV_EXCL_LINE</span>
<span id="L963"><span class="lineNum">     963</span>              :                 num_avail_hist_fields_3Df + &amp;   ! LCOV_EXCL_LINE</span>
<span id="L964"><span class="lineNum">     964</span>              :                 num_avail_hist_fields_4Di + &amp;   ! LCOV_EXCL_LINE</span>
<span id="L965"><span class="lineNum">     965</span>              :                 num_avail_hist_fields_4Ds + &amp;   ! LCOV_EXCL_LINE</span>
<span id="L966"><span class="lineNum">     966</span>              :                 num_avail_hist_fields_4Df) then</span>
<span id="L967"><span class="lineNum">     967</span> <span class="tlaUNC tlaBgUNC">           0 :                if (my_task == master_task) then</span></span>
<span id="L968"><span class="lineNum">     968</span> <span class="tlaUNC">           0 :                   write(nu_diag,*) subname,' num_avail_hist_fields_tot = ',num_avail_hist_fields_tot</span></span>
<span id="L969"><span class="lineNum">     969</span>              :                endif</span>
<span id="L970"><span class="lineNum">     970</span> <span class="tlaUNC">           0 :                call abort_ice(subname//' ERROR: in num_avail_hist_fields')</span></span>
<span id="L971"><span class="lineNum">     971</span>              :             endif</span>
<span id="L972"><span class="lineNum">     972</span>              : </span>
<span id="L973"><span class="lineNum">     973</span> <span class="tlaGNC tlaBgGNC">        1837 :             id(ns) = num_avail_hist_fields_tot</span></span>
<span id="L974"><span class="lineNum">     974</span>              : </span>
<span id="L975"><span class="lineNum">     975</span> <span class="tlaGNC">        1837 :             stmp = vname</span></span>
<span id="L976"><span class="lineNum">     976</span> <span class="tlaGNC">        1837 :             if (ns &gt; 1) &amp;</span></span>
<span id="L977"><span class="lineNum">     977</span> <span class="tlaUNC tlaBgUNC">           0 :                write(stmp,'(a,a1,a1)') trim(stmp),'_',vhistfreq(ns1:ns1)</span></span>
<span id="L978"><span class="lineNum">     978</span>              : </span>
<span id="L979"><span class="lineNum">     979</span> <span class="tlaGNC tlaBgGNC">        1837 :             avail_hist_fields(id(ns))%vname = trim(stmp)</span></span>
<span id="L980"><span class="lineNum">     980</span> <span class="tlaGNC">        1837 :             avail_hist_fields(id(ns))%vunit = trim(vunit)</span></span>
<span id="L981"><span class="lineNum">     981</span> <span class="tlaGNC">        1837 :             avail_hist_fields(id(ns))%vcoord = trim(vcoord)</span></span>
<span id="L982"><span class="lineNum">     982</span> <span class="tlaGNC">        1837 :             avail_hist_fields(id(ns))%vcellmeas = trim(vcellmeas)</span></span>
<span id="L983"><span class="lineNum">     983</span> <span class="tlaGNC">        1837 :             avail_hist_fields(id(ns))%vdesc = trim(vdesc)</span></span>
<span id="L984"><span class="lineNum">     984</span> <span class="tlaGNC">        1837 :             avail_hist_fields(id(ns))%vcomment = trim(vcomment)</span></span>
<span id="L985"><span class="lineNum">     985</span> <span class="tlaGNC">        1837 :             avail_hist_fields(id(ns))%cona = cona</span></span>
<span id="L986"><span class="lineNum">     986</span> <span class="tlaGNC">        1837 :             avail_hist_fields(id(ns))%conb = conb</span></span>
<span id="L987"><span class="lineNum">     987</span> <span class="tlaGNC">        1837 :             avail_hist_fields(id(ns))%vhistfreq = vhistfreq(ns1:ns1)</span></span>
<span id="L988"><span class="lineNum">     988</span> <span class="tlaGNC">        1837 :             avail_hist_fields(id(ns))%vhistfreq_n = histfreq_n(ns)</span></span>
<span id="L989"><span class="lineNum">     989</span> <span class="tlaGNC">        1837 :             avail_hist_fields(id(ns))%avg_ice_present = l_avg_ice_present</span></span>
<span id="L990"><span class="lineNum">     990</span> <span class="tlaGNC">        1837 :             avail_hist_fields(id(ns))%mask_ice_free_points = l_mask_ice_free_points</span></span>
<span id="L991"><span class="lineNum">     991</span>              : </span>
<span id="L992"><span class="lineNum">     992</span>              :          endif</span>
<span id="L993"><span class="lineNum">     993</span>              :       enddo</span>
<span id="L994"><span class="lineNum">     994</span>              : </span>
<span id="L995"><span class="lineNum">     995</span> <span class="tlaGNC">        8880 :       end subroutine define_hist_field</span></span>
<span id="L996"><span class="lineNum">     996</span>              : </span>
<span id="L997"><span class="lineNum">     997</span>              : !=======================================================================</span>
<span id="L998"><span class="lineNum">     998</span>              : </span>
<span id="L999"><span class="lineNum">     999</span>              : !     Accumulates a history field</span>
<span id="L1000"><span class="lineNum">    1000</span>              : !</span>
<span id="L1001"><span class="lineNum">    1001</span>              : !     2009 Created by D. Bailey following POP</span>
<span id="L1002"><span class="lineNum">    1002</span>              : !     2010 Generalized dimension of variables by N. Jeffery, E. Hunke</span>
<span id="L1003"><span class="lineNum">    1003</span>              : </span>
<span id="L1004"><span class="lineNum">    1004</span> <span class="tlaGNC">     1547968 :       subroutine accum_hist_field_2D(id, iblk, field_accum, field)</span></span>
<span id="L1005"><span class="lineNum">    1005</span>              : </span>
<span id="L1006"><span class="lineNum">    1006</span>              :       use ice_blocks, only: block, get_block</span>
<span id="L1007"><span class="lineNum">    1007</span>              :       use ice_calendar, only: nstreams</span>
<span id="L1008"><span class="lineNum">    1008</span>              :       use ice_domain, only: blocks_ice</span>
<span id="L1009"><span class="lineNum">    1009</span>              :       use ice_grid, only: tmask</span>
<span id="L1010"><span class="lineNum">    1010</span>              : </span>
<span id="L1011"><span class="lineNum">    1011</span>              :       integer (int_kind), dimension(:), intent(in) :: &amp;  ! max_nstrm</span>
<span id="L1012"><span class="lineNum">    1012</span>              :          id                ! location in avail_fields array for use in</span>
<span id="L1013"><span class="lineNum">    1013</span>              :                            ! later routines</span>
<span id="L1014"><span class="lineNum">    1014</span>              : </span>
<span id="L1015"><span class="lineNum">    1015</span>              :       integer (kind=int_kind), intent(in) :: iblk</span>
<span id="L1016"><span class="lineNum">    1016</span>              : </span>
<span id="L1017"><span class="lineNum">    1017</span>              :       real (kind=dbl_kind), intent(in) :: &amp;</span>
<span id="L1018"><span class="lineNum">    1018</span>              :          field_accum(:,:)</span>
<span id="L1019"><span class="lineNum">    1019</span>              : </span>
<span id="L1020"><span class="lineNum">    1020</span>              :       real (kind=dbl_kind), intent(inout) :: &amp;</span>
<span id="L1021"><span class="lineNum">    1021</span>              :          field(:,:,:,:)</span>
<span id="L1022"><span class="lineNum">    1022</span>              : </span>
<span id="L1023"><span class="lineNum">    1023</span>              :       type (block) :: &amp;</span>
<span id="L1024"><span class="lineNum">    1024</span>              :          this_block           ! block information for current block</span>
<span id="L1025"><span class="lineNum">    1025</span>              : </span>
<span id="L1026"><span class="lineNum">    1026</span>              :       integer (kind=int_kind) :: i,j, ilo, ihi, jlo, jhi, ns, idns</span>
<span id="L1027"><span class="lineNum">    1027</span>              : </span>
<span id="L1028"><span class="lineNum">    1028</span>              :       character(len=*), parameter :: subname = '(accum_hist_field_2D)'</span>
<span id="L1029"><span class="lineNum">    1029</span>              : </span>
<span id="L1030"><span class="lineNum">    1030</span>              :       !---------------------------------------------------------------</span>
<span id="L1031"><span class="lineNum">    1031</span>              :       ! increment field</span>
<span id="L1032"><span class="lineNum">    1032</span>              :       !---------------------------------------------------------------</span>
<span id="L1033"><span class="lineNum">    1033</span>              : </span>
<span id="L1034"><span class="lineNum">    1034</span> <span class="tlaGNC">     3095936 :        do ns = 1, nstreams</span></span>
<span id="L1035"><span class="lineNum">    1035</span> <span class="tlaGNC">     1547968 :        idns = id(ns)</span></span>
<span id="L1036"><span class="lineNum">    1036</span> <span class="tlaGNC">     3095936 :        if (idns &gt; 0) then</span></span>
<span id="L1037"><span class="lineNum">    1037</span>              : </span>
<span id="L1038"><span class="lineNum">    1038</span> <span class="tlaGNC">      787648 :        this_block = get_block(blocks_ice(iblk),iblk)</span></span>
<span id="L1039"><span class="lineNum">    1039</span> <span class="tlaGNC">      787648 :        ilo = this_block%ilo</span></span>
<span id="L1040"><span class="lineNum">    1040</span> <span class="tlaGNC">      787648 :        ihi = this_block%ihi</span></span>
<span id="L1041"><span class="lineNum">    1041</span> <span class="tlaGNC">      787648 :        jlo = this_block%jlo</span></span>
<span id="L1042"><span class="lineNum">    1042</span> <span class="tlaGNC">      787648 :        jhi = this_block%jhi</span></span>
<span id="L1043"><span class="lineNum">    1043</span>              : </span>
<span id="L1044"><span class="lineNum">    1044</span> <span class="tlaGNC">    24795807 :        do j = jlo, jhi</span></span>
<span id="L1045"><span class="lineNum">    1045</span> <span class="tlaGNC">   706599398 :        do i = ilo, ihi</span></span>
<span id="L1046"><span class="lineNum">    1046</span> <span class="tlaGNC">   705811750 :           if (tmask(i,j,iblk)) then</span></span>
<span id="L1047"><span class="lineNum">    1047</span> <span class="tlaGNC">   581953726 :              field(i,j,idns, iblk) = field(i,j,idns, iblk) + field_accum(i,j)</span></span>
<span id="L1048"><span class="lineNum">    1048</span>              :           endif</span>
<span id="L1049"><span class="lineNum">    1049</span>              :        enddo</span>
<span id="L1050"><span class="lineNum">    1050</span>              :        enddo</span>
<span id="L1051"><span class="lineNum">    1051</span>              : </span>
<span id="L1052"><span class="lineNum">    1052</span>              :        endif</span>
<span id="L1053"><span class="lineNum">    1053</span>              :        enddo</span>
<span id="L1054"><span class="lineNum">    1054</span>              : </span>
<span id="L1055"><span class="lineNum">    1055</span> <span class="tlaGNC">     1547968 :       end subroutine accum_hist_field_2D</span></span>
<span id="L1056"><span class="lineNum">    1056</span>              : </span>
<span id="L1057"><span class="lineNum">    1057</span>              : !=======================================================================</span>
<span id="L1058"><span class="lineNum">    1058</span>              : </span>
<span id="L1059"><span class="lineNum">    1059</span>              : !     Accumulates a history field</span>
<span id="L1060"><span class="lineNum">    1060</span>              : !</span>
<span id="L1061"><span class="lineNum">    1061</span>              : !     2009 Created by D. Bailey following POP</span>
<span id="L1062"><span class="lineNum">    1062</span>              : !     2010 Generalized dimension of variables by N. Jeffery, E. Hunke</span>
<span id="L1063"><span class="lineNum">    1063</span>              : </span>
<span id="L1064"><span class="lineNum">    1064</span> <span class="tlaUNC tlaBgUNC">           0 :       subroutine accum_hist_field_3D(id, iblk, ndim, field_accum, field)</span></span>
<span id="L1065"><span class="lineNum">    1065</span>              : </span>
<span id="L1066"><span class="lineNum">    1066</span>              :       use ice_blocks, only: block, get_block</span>
<span id="L1067"><span class="lineNum">    1067</span>              :       use ice_calendar, only: nstreams</span>
<span id="L1068"><span class="lineNum">    1068</span>              :       use ice_domain, only: blocks_ice</span>
<span id="L1069"><span class="lineNum">    1069</span>              :       use ice_grid, only: tmask</span>
<span id="L1070"><span class="lineNum">    1070</span>              : </span>
<span id="L1071"><span class="lineNum">    1071</span>              :       integer (int_kind), dimension(:), intent(in) :: &amp;  ! max_nstrm</span>
<span id="L1072"><span class="lineNum">    1072</span>              :          id                ! location in avail_fields array for use in</span>
<span id="L1073"><span class="lineNum">    1073</span>              :                            ! later routines</span>
<span id="L1074"><span class="lineNum">    1074</span>              : </span>
<span id="L1075"><span class="lineNum">    1075</span>              :       integer (kind=int_kind), intent(in) :: iblk</span>
<span id="L1076"><span class="lineNum">    1076</span>              : </span>
<span id="L1077"><span class="lineNum">    1077</span>              :       integer (kind=int_kind), intent(in) :: &amp;</span>
<span id="L1078"><span class="lineNum">    1078</span>              :          ndim              ! third dimension size</span>
<span id="L1079"><span class="lineNum">    1079</span>              : </span>
<span id="L1080"><span class="lineNum">    1080</span>              :       real (kind=dbl_kind), intent(in) :: &amp;</span>
<span id="L1081"><span class="lineNum">    1081</span>              :          field_accum(:,:,:)</span>
<span id="L1082"><span class="lineNum">    1082</span>              : </span>
<span id="L1083"><span class="lineNum">    1083</span>              :       real (kind=dbl_kind), intent(inout) :: &amp;</span>
<span id="L1084"><span class="lineNum">    1084</span>              :          field(:,:,:,:,:)</span>
<span id="L1085"><span class="lineNum">    1085</span>              : </span>
<span id="L1086"><span class="lineNum">    1086</span>              :       type (block) :: &amp;</span>
<span id="L1087"><span class="lineNum">    1087</span>              :          this_block           ! block information for current block</span>
<span id="L1088"><span class="lineNum">    1088</span>              : </span>
<span id="L1089"><span class="lineNum">    1089</span>              :       integer (kind=int_kind) :: i,j,k, ilo, ihi, jlo, jhi, ns, idns</span>
<span id="L1090"><span class="lineNum">    1090</span>              : </span>
<span id="L1091"><span class="lineNum">    1091</span>              :       character(len=*), parameter :: subname = '(accum_hist_field_3D)'</span>
<span id="L1092"><span class="lineNum">    1092</span>              : </span>
<span id="L1093"><span class="lineNum">    1093</span>              :       !---------------------------------------------------------------</span>
<span id="L1094"><span class="lineNum">    1094</span>              :       ! increment field</span>
<span id="L1095"><span class="lineNum">    1095</span>              :       !---------------------------------------------------------------</span>
<span id="L1096"><span class="lineNum">    1096</span>              : </span>
<span id="L1097"><span class="lineNum">    1097</span> <span class="tlaUNC">           0 :        do ns = 1, nstreams</span></span>
<span id="L1098"><span class="lineNum">    1098</span> <span class="tlaUNC">           0 :        idns = id(ns)</span></span>
<span id="L1099"><span class="lineNum">    1099</span> <span class="tlaUNC">           0 :        if (idns &gt; 0) then</span></span>
<span id="L1100"><span class="lineNum">    1100</span>              : </span>
<span id="L1101"><span class="lineNum">    1101</span> <span class="tlaUNC">           0 :        this_block = get_block(blocks_ice(iblk),iblk)</span></span>
<span id="L1102"><span class="lineNum">    1102</span> <span class="tlaUNC">           0 :        ilo = this_block%ilo</span></span>
<span id="L1103"><span class="lineNum">    1103</span> <span class="tlaUNC">           0 :        ihi = this_block%ihi</span></span>
<span id="L1104"><span class="lineNum">    1104</span> <span class="tlaUNC">           0 :        jlo = this_block%jlo</span></span>
<span id="L1105"><span class="lineNum">    1105</span> <span class="tlaUNC">           0 :        jhi = this_block%jhi</span></span>
<span id="L1106"><span class="lineNum">    1106</span>              : </span>
<span id="L1107"><span class="lineNum">    1107</span> <span class="tlaUNC">           0 :        do k = 1, ndim</span></span>
<span id="L1108"><span class="lineNum">    1108</span> <span class="tlaUNC">           0 :        do j = jlo, jhi</span></span>
<span id="L1109"><span class="lineNum">    1109</span> <span class="tlaUNC">           0 :        do i = ilo, ihi</span></span>
<span id="L1110"><span class="lineNum">    1110</span> <span class="tlaUNC">           0 :           if (tmask(i,j,iblk)) then</span></span>
<span id="L1111"><span class="lineNum">    1111</span> <span class="tlaUNC">           0 :              field(i,j,k,idns,iblk) = field(i,j,k,idns,iblk) + field_accum(i,j,k)</span></span>
<span id="L1112"><span class="lineNum">    1112</span>              :           endif</span>
<span id="L1113"><span class="lineNum">    1113</span>              :        enddo</span>
<span id="L1114"><span class="lineNum">    1114</span>              :        enddo</span>
<span id="L1115"><span class="lineNum">    1115</span>              :        enddo</span>
<span id="L1116"><span class="lineNum">    1116</span>              : </span>
<span id="L1117"><span class="lineNum">    1117</span>              :        endif</span>
<span id="L1118"><span class="lineNum">    1118</span>              :        enddo</span>
<span id="L1119"><span class="lineNum">    1119</span>              : </span>
<span id="L1120"><span class="lineNum">    1120</span> <span class="tlaUNC">           0 :       end subroutine accum_hist_field_3D</span></span>
<span id="L1121"><span class="lineNum">    1121</span>              : </span>
<span id="L1122"><span class="lineNum">    1122</span>              : !=======================================================================</span>
<span id="L1123"><span class="lineNum">    1123</span>              : </span>
<span id="L1124"><span class="lineNum">    1124</span>              : !     Accumulates a history field</span>
<span id="L1125"><span class="lineNum">    1125</span>              : !</span>
<span id="L1126"><span class="lineNum">    1126</span>              : !     2009 Created by D. Bailey following POP</span>
<span id="L1127"><span class="lineNum">    1127</span>              : !     2010 Generalized dimension of variables by N. Jeffery, E. Hunke</span>
<span id="L1128"><span class="lineNum">    1128</span>              : </span>
<span id="L1129"><span class="lineNum">    1129</span> <span class="tlaUNC">           0 :       subroutine accum_hist_field_4D(id, iblk, ndim3, ndim4, field_accum, field)</span></span>
<span id="L1130"><span class="lineNum">    1130</span>              : </span>
<span id="L1131"><span class="lineNum">    1131</span>              :       use ice_blocks, only: block, get_block</span>
<span id="L1132"><span class="lineNum">    1132</span>              :       use ice_calendar, only: nstreams</span>
<span id="L1133"><span class="lineNum">    1133</span>              :       use ice_domain, only: blocks_ice</span>
<span id="L1134"><span class="lineNum">    1134</span>              :       use ice_grid, only: tmask</span>
<span id="L1135"><span class="lineNum">    1135</span>              : </span>
<span id="L1136"><span class="lineNum">    1136</span>              :       integer (int_kind), dimension(:), intent(in) :: &amp;  ! max_nstrm</span>
<span id="L1137"><span class="lineNum">    1137</span>              :          id                ! location in avail_fields array for use in</span>
<span id="L1138"><span class="lineNum">    1138</span>              :                            ! later routines</span>
<span id="L1139"><span class="lineNum">    1139</span>              : </span>
<span id="L1140"><span class="lineNum">    1140</span>              :       integer (kind=int_kind), intent(in) :: iblk</span>
<span id="L1141"><span class="lineNum">    1141</span>              : </span>
<span id="L1142"><span class="lineNum">    1142</span>              :       integer (kind=int_kind), intent(in) :: &amp;</span>
<span id="L1143"><span class="lineNum">    1143</span>              :          ndim3  , &amp;        ! third dimension size   ! LCOV_EXCL_LINE</span>
<span id="L1144"><span class="lineNum">    1144</span>              :          ndim4             ! fourth dimension size</span>
<span id="L1145"><span class="lineNum">    1145</span>              : </span>
<span id="L1146"><span class="lineNum">    1146</span>              :       real (kind=dbl_kind), intent(in) :: &amp;</span>
<span id="L1147"><span class="lineNum">    1147</span>              :          field_accum(:,:,:,:)</span>
<span id="L1148"><span class="lineNum">    1148</span>              : </span>
<span id="L1149"><span class="lineNum">    1149</span>              :       real (kind=dbl_kind), intent(inout) :: &amp;</span>
<span id="L1150"><span class="lineNum">    1150</span>              :          field(:,:,:,:,:,:)</span>
<span id="L1151"><span class="lineNum">    1151</span>              : </span>
<span id="L1152"><span class="lineNum">    1152</span>              :       type (block) :: &amp;</span>
<span id="L1153"><span class="lineNum">    1153</span>              :          this_block           ! block information for current block</span>
<span id="L1154"><span class="lineNum">    1154</span>              : </span>
<span id="L1155"><span class="lineNum">    1155</span>              :       integer (kind=int_kind) :: i,j,k,n,ilo, ihi, jlo, jhi, ns, idns</span>
<span id="L1156"><span class="lineNum">    1156</span>              : </span>
<span id="L1157"><span class="lineNum">    1157</span>              :       character(len=*), parameter :: subname = '(accum_hist_field_4D)'</span>
<span id="L1158"><span class="lineNum">    1158</span>              : </span>
<span id="L1159"><span class="lineNum">    1159</span>              :       !---------------------------------------------------------------</span>
<span id="L1160"><span class="lineNum">    1160</span>              :       ! increment field</span>
<span id="L1161"><span class="lineNum">    1161</span>              :       !---------------------------------------------------------------</span>
<span id="L1162"><span class="lineNum">    1162</span>              : </span>
<span id="L1163"><span class="lineNum">    1163</span> <span class="tlaUNC">           0 :        do ns = 1, nstreams</span></span>
<span id="L1164"><span class="lineNum">    1164</span> <span class="tlaUNC">           0 :        idns = id(ns)</span></span>
<span id="L1165"><span class="lineNum">    1165</span> <span class="tlaUNC">           0 :        if (idns &gt; 0) then</span></span>
<span id="L1166"><span class="lineNum">    1166</span>              : </span>
<span id="L1167"><span class="lineNum">    1167</span> <span class="tlaUNC">           0 :        this_block = get_block(blocks_ice(iblk),iblk)</span></span>
<span id="L1168"><span class="lineNum">    1168</span> <span class="tlaUNC">           0 :        ilo = this_block%ilo</span></span>
<span id="L1169"><span class="lineNum">    1169</span> <span class="tlaUNC">           0 :        ihi = this_block%ihi</span></span>
<span id="L1170"><span class="lineNum">    1170</span> <span class="tlaUNC">           0 :        jlo = this_block%jlo</span></span>
<span id="L1171"><span class="lineNum">    1171</span> <span class="tlaUNC">           0 :        jhi = this_block%jhi</span></span>
<span id="L1172"><span class="lineNum">    1172</span>              : </span>
<span id="L1173"><span class="lineNum">    1173</span> <span class="tlaUNC">           0 :        do k = 1, ndim4</span></span>
<span id="L1174"><span class="lineNum">    1174</span> <span class="tlaUNC">           0 :        do n = 1, ndim3</span></span>
<span id="L1175"><span class="lineNum">    1175</span> <span class="tlaUNC">           0 :        do j = jlo, jhi</span></span>
<span id="L1176"><span class="lineNum">    1176</span> <span class="tlaUNC">           0 :        do i = ilo, ihi</span></span>
<span id="L1177"><span class="lineNum">    1177</span> <span class="tlaUNC">           0 :           if (tmask(i,j,iblk)) then</span></span>
<span id="L1178"><span class="lineNum">    1178</span> <span class="tlaUNC">           0 :              field(i,j,n,k,idns,iblk) = field(i,j,n,k,idns,iblk) + field_accum(i,j,n,k)</span></span>
<span id="L1179"><span class="lineNum">    1179</span>              :           endif</span>
<span id="L1180"><span class="lineNum">    1180</span>              :        enddo</span>
<span id="L1181"><span class="lineNum">    1181</span>              :        enddo</span>
<span id="L1182"><span class="lineNum">    1182</span>              :        enddo</span>
<span id="L1183"><span class="lineNum">    1183</span>              :        enddo</span>
<span id="L1184"><span class="lineNum">    1184</span>              : </span>
<span id="L1185"><span class="lineNum">    1185</span>              :        endif</span>
<span id="L1186"><span class="lineNum">    1186</span>              :        enddo</span>
<span id="L1187"><span class="lineNum">    1187</span>              : </span>
<span id="L1188"><span class="lineNum">    1188</span> <span class="tlaUNC">           0 :       end subroutine accum_hist_field_4D</span></span>
<span id="L1189"><span class="lineNum">    1189</span>              : </span>
<span id="L1190"><span class="lineNum">    1190</span>              : !=======================================================================</span>
<span id="L1191"><span class="lineNum">    1191</span>              : </span>
<span id="L1192"><span class="lineNum">    1192</span> <span class="tlaUNC">           0 :       end module ice_history_shared</span></span>
<span id="L1193"><span class="lineNum">    1193</span>              : </span>
<span id="L1194"><span class="lineNum">    1194</span>              : !=======================================================================</span>
        </pre>
              </td>
            </tr>
          </table>
          <br>

          <table width="100%" border=0 cellspacing=0 cellpadding=0>
            <tr><td class="ruler"><img src="../../../glass.png" width=3 height=3 alt=""></td></tr>
            <tr><td class="versionInfo">Generated by: <a href="https://github.com//linux-test-project/lcov" target="_parent">LCOV version 2.0-1</a></td></tr>
          </table>
          <br>

</body>
</html>
